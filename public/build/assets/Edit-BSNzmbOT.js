import{s as E,L as B,c as a,H as L,x as j,w as R,b as h,o as l,e as q,f as w,g as m,u as n,h as C,i as N,W as f,O as _,l as b}from"./app-0hD9jktS.js";import{_ as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-C_OfVMdc.js";import{_ as T}from"./AdmissionsForm.vue_vue_type_script_setup_true_lang-Ap7fPlA1.js";import{u as V}from"./school-SWVnhMs_.js";import"./RovingFocusGroup-BrsbekXI.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DLhJV-ve.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DV00-4L5.js";import"./building-2-0J7JWYjO.js";import"./users-CQiJNf1m.js";import"./chevron-down-Bc9-FnA7.js";import"./check-DytFQTDT.js";import"./SelectInput-C8qFFp1m.js";import"./Label.vue_vue_type_script_setup_true_lang-CLv8w6I-.js";import"./Input.vue_vue_type_script_setup_true_lang-ByoFr_iA.js";import"./InputError.vue_vue_type_script_setup_true_lang-BnFbo3YU.js";import"./FileInput-kSoIAmJU.js";import"./Icon.vue_vue_type_script_setup_true_lang-DgG5U0yt.js";import"./loader-circle-Dg-d1WoA.js";import"./target-nv-k3IQz.js";import"./triangle-alert-dLAnWNBM.js";import"./refresh-cw-DBp2ONfo.js";import"./save-DvCxJJrq.js";import"./plus-DX8dkZyx.js";import"./arrow-right-yGz9ZWmd.js";import"./arrow-left-B5cZ3DqQ.js";import"./eye-off-B84CHv0x.js";import"./eye-Dtz9j6o0.js";import"./shield-BxF9Ptyz.js";import"./square-pen-QEAPgpV6.js";import"./info-DWKpZpD6.js";import"./calendar-DjniW4jB.js";import"./house-D65vkcx-.js";import"./book-open-Dculjk7S.js";import"./trash-hGn8IamB.js";const W={class:"p-4 bg-neutral-100 dark:bg-neutral-900 min-h-screen"},$={key:1,class:"flex items-center justify-center py-10"},xe={__name:"Edit",setup(D){const v=[{title:"Students",href:"/students"},{title:"Edit Student"}],e=E().props.student,c=V(),{schools:d,classes:u,selectedSchool:g}=B(c),r=a(()=>Array.isArray(d.value)?d.value:[]),p=a(()=>Array.isArray(u.value)?u.value:[]),y=a(()=>r.value),x=a(()=>p.value.map(s=>({label:s.name,value:s.id})));L(()=>{r.value.length||c.fetchSchools()});const o=j({school_id:e.school_id,class_id:e.class_id,nationality:e.nationality,registration_number:e.registration_number,name:e.name,b_form_number:e.b_form_number,admission_date:e.admission_date,date_of_birth:e.date_of_birth,gender:e.gender,class_shift:e.class_shift,previous_school:e.previous_school,inclusive:e.inclusive,other_inclusive_type:e.other_inclusive_type,religion:e.religion,is_bricklin:e.is_bricklin,is_orphan:e.is_orphan,is_qsc:e.is_qsc,profile_photo_path:null,father_name:e.father_name,guardian_name:e.guardian_name,father_cnic:e.father_cnic,mother_cnic:e.mother_cnic,father_profession:e.father_profession,no_of_children:e.no_of_children,job_type:e.job_type,father_education:e.father_education,mother_education:e.mother_education,mother_profession:e.mother_profession,father_income:e.father_income,mother_income:e.mother_income,household_income:e.household_income,permanent_address:e.permanent_address,phone_no:e.phone_no,mobile_no:e.mobile_no});R([()=>g.value,()=>r.value],([s,t])=>{if(s&&Array.isArray(t)&&t.length>0){const i=t.find(A=>A.id===s.id);i&&o.school_id!==i.id&&(o.school_id=i.id,c.setSchool(i))}},{immediate:!0});function k(){o.post(_("students.update",e.id),{forceFormData:!0,data:{...o.data(),_method:"PUT"},onSuccess:()=>{b.success("Student updated successfully!"),f.visit(_("students.index"))},onError:()=>{b.error("Please fix the errors in the form.")}})}function S(){f.visit(_("students.index"))}return(s,t)=>(l(),h(P,{breadcrumbs:v},{default:q(()=>[w(n(C),{title:"Edit Student"}),m("div",W,[t[1]||(t[1]=m("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 mb-4"},"Edit Student",-1)),r.value.length&&p.value.length?(l(),h(T,{key:0,form:n(o),errors:n(o).errors,mode:"edit",classes:x.value,schools:y.value,"existing-photo":n(e).profile_photo_path,onSubmit:k,onCancel:S},null,8,["form","errors","classes","schools","existing-photo"])):(l(),N("div",$,t[0]||(t[0]=[m("span",null,"Loading...",-1)])))])]),_:1}))}};export{xe as default};
