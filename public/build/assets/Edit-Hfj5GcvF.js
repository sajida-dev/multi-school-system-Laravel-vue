import{s as E,L as B,c as a,H as L,x as j,w as R,b as h,o as l,e as q,f as w,g as m,u as n,h as C,i as N,W as f,O as _,l as b}from"./app-oDzFbDpS.js";import{_ as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-B8xcv65_.js";import{_ as T}from"./AdmissionsForm.vue_vue_type_script_setup_true_lang-BYY5rFtq.js";import{u as V}from"./school-T4gwIvXC.js";import"./RovingFocusGroup-CLnOwjDo.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DPNLz3sn.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cob2K5o9.js";import"./building-2-Dp0U14zc.js";import"./users-DDnJbTSp.js";import"./chevron-down-SN-issHr.js";import"./check-CEIiCWnz.js";import"./SelectInput-DixG2iKA.js";import"./Label.vue_vue_type_script_setup_true_lang-BphRAz40.js";import"./Input.vue_vue_type_script_setup_true_lang-CJXbLAqT.js";import"./InputError.vue_vue_type_script_setup_true_lang-DL9oimPF.js";import"./FileInput-BK6eYL8g.js";import"./Icon.vue_vue_type_script_setup_true_lang-CktM08l_.js";import"./loader-circle-Dd3mNCCo.js";import"./target-BvkpxWi2.js";import"./triangle-alert-DX_7JuLF.js";import"./refresh-cw-CWAu1Of8.js";import"./save-BhC_gGhx.js";import"./plus-DaPcSaFA.js";import"./arrow-right-Dpm9A9Fy.js";import"./arrow-left-DCJF3lDn.js";import"./eye-off-ByIEJSqi.js";import"./eye-DjBiqAnr.js";import"./shield-CQ-AXaLs.js";import"./square-pen-D5JRiJpv.js";import"./info-Cu4eEvQq.js";import"./calendar-NzJ3-Hzp.js";import"./house-CZga5bkn.js";import"./book-open-NJHJ4pEX.js";import"./trash-Byk8sBRk.js";const W={class:"p-4 bg-neutral-100 dark:bg-neutral-900 min-h-screen"},$={key:1,class:"flex items-center justify-center py-10"},xe={__name:"Edit",setup(D){const v=[{title:"Students",href:"/students"},{title:"Edit Student"}],e=E().props.student,c=V(),{schools:d,classes:u,selectedSchool:g}=B(c),r=a(()=>Array.isArray(d.value)?d.value:[]),p=a(()=>Array.isArray(u.value)?u.value:[]),y=a(()=>r.value),x=a(()=>p.value.map(s=>({label:s.name,value:s.id})));L(()=>{r.value.length||c.fetchSchools()});const o=j({school_id:e.school_id,class_id:e.class_id,nationality:e.nationality,registration_number:e.registration_number,name:e.name,b_form_number:e.b_form_number,admission_date:e.admission_date,date_of_birth:e.date_of_birth,gender:e.gender,class_shift:e.class_shift,previous_school:e.previous_school,inclusive:e.inclusive,other_inclusive_type:e.other_inclusive_type,religion:e.religion,is_bricklin:e.is_bricklin,is_orphan:e.is_orphan,is_qsc:e.is_qsc,profile_photo_path:null,father_name:e.father_name,guardian_name:e.guardian_name,father_cnic:e.father_cnic,mother_cnic:e.mother_cnic,father_profession:e.father_profession,no_of_children:e.no_of_children,job_type:e.job_type,father_education:e.father_education,mother_education:e.mother_education,mother_profession:e.mother_profession,father_income:e.father_income,mother_income:e.mother_income,household_income:e.household_income,permanent_address:e.permanent_address,phone_no:e.phone_no,mobile_no:e.mobile_no});R([()=>g.value,()=>r.value],([s,t])=>{if(s&&Array.isArray(t)&&t.length>0){const i=t.find(A=>A.id===s.id);i&&o.school_id!==i.id&&(o.school_id=i.id,c.setSchool(i))}},{immediate:!0});function k(){o.post(_("students.update",e.id),{forceFormData:!0,data:{...o.data(),_method:"PUT"},onSuccess:()=>{b.success("Student updated successfully!"),f.visit(_("students.index"))},onError:()=>{b.error("Please fix the errors in the form.")}})}function S(){f.visit(_("students.index"))}return(s,t)=>(l(),h(P,{breadcrumbs:v},{default:q(()=>[w(n(C),{title:"Edit Student"}),m("div",W,[t[1]||(t[1]=m("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 mb-4"},"Edit Student",-1)),r.value.length&&p.value.length?(l(),h(T,{key:0,form:n(o),errors:n(o).errors,mode:"edit",classes:x.value,schools:y.value,"existing-photo":n(e).profile_photo_path,onSubmit:k,onCancel:S},null,8,["form","errors","classes","schools","existing-photo"])):(l(),N("div",$,t[0]||(t[0]=[m("span",null,"Loading...",-1)])))])]),_:1}))}};export{xe as default};
