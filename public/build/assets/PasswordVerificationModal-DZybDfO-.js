import{r as c,b,o as a,e as S,g as e,p as j,i as g,z as x,k as P,P as V,u as w,t as $,E,x as M,l as f,w as z,j as B}from"./app-0hD9jktS.js";import{E as C}from"./eye-Dtz9j6o0.js";import{E as _}from"./eye-off-B84CHv0x.js";const A={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm"},N={class:"relative z-50 bg-white dark:bg-neutral-800 p-6 rounded-lg shadow-xl border border-gray-200 dark:border-neutral-700 min-w-[400px] max-w-md mx-auto w-full"},U={class:"mb-4"},R={class:"relative"},q=["type"],D={class:"mb-4"},O={class:"relative"},F=["type"],I={key:0,class:"text-xs text-red-500 mb-2"},G={class:"flex justify-end gap-2 mt-4"},H=["disabled"],T={key:0},J={key:1},ae={__name:"PasswordResetModal",props:{userId:{type:[String,Number],required:!0}},emits:["success","cancel"],setup(d,{emit:k}){const h=d,y=k,l=c(""),m=c(""),o=c(""),u=c(!1),p=c(!1),v=c(!1);function i(){const r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";let t="";for(let n=0;n<12;n++)t+=r.charAt(Math.floor(Math.random()*r.length));m.value=t}i();function s(){o.value="",u.value=!0,M({user_id:h.userId,admin_password:l.value,new_password:m.value}).post("/settings/user-management/reset-password",{preserveScroll:!0,onSuccess:r=>{u.value=!1,console.log("response",r),r.success?(y("success",r.success),f.success("Password reset successfully")):r.error?(o.value=r.error,f.error(o.value)):(o.value="Password reset failed. Please try again.",f.error(o.value))},onError:r=>{u.value=!1,o.value=Object.values(r).flat().join(" "),f.error(o.value)}})}return(r,t)=>(a(),b(E,{"model-value":!0,"onUpdate:modelValue":t[5]||(t[5]=n=>r.$emit("cancel"))},{default:S(()=>[e("div",A,[e("div",N,[t[8]||(t[8]=e("h2",{class:"text-lg font-bold mb-4 text-center"},"Reset User Password",-1)),e("form",{onSubmit:j(s,["prevent"])},[e("div",U,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium mb-1"},"Admin Password (for verification)",-1)),e("div",R,[P(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>l.value=n),type:p.value?"text":"password",class:"w-full px-3 py-2 pr-10 rounded border border-gray-300 dark:border-neutral-600 dark:bg-neutral-800 dark:text-white focus:ring-2 focus:ring-blue-400 focus:border-blue-500 dark:focus:border-blue-400",autocomplete:"current-password",required:""},null,8,q),[[V,l.value]]),e("button",{type:"button",onClick:t[1]||(t[1]=n=>p.value=!p.value),class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[p.value?(a(),b(w(_),{key:1,class:"w-4 h-4"})):(a(),b(w(C),{key:0,class:"w-4 h-4"}))])])]),e("div",D,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium mb-1"},"New Password",-1)),e("div",O,[P(e("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>m.value=n),type:v.value?"text":"password",class:"w-full px-3 py-2 pr-10 rounded border border-gray-300 dark:border-neutral-600 dark:bg-neutral-800 dark:text-white focus:ring-2 focus:ring-blue-400 focus:border-blue-500 dark:focus:border-blue-400",autocomplete:"new-password",required:""},null,8,F),[[V,m.value]]),e("button",{type:"button",onClick:t[3]||(t[3]=n=>v.value=!v.value),class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[v.value?(a(),b(w(_),{key:1,class:"w-4 h-4"})):(a(),b(w(C),{key:0,class:"w-4 h-4"}))])]),e("button",{type:"button",class:"mt-2 text-xs text-blue-600 hover:underline",onClick:i},"Generate Random Password")]),o.value?(a(),g("div",I,$(o.value),1)):x("",!0),e("div",G,[e("button",{onClick:t[4]||(t[4]=n=>r.$emit("cancel")),type:"button",class:"px-4 py-2 rounded bg-gray-200 dark:bg-neutral-700 text-gray-700 dark:text-white hover:bg-gray-300 dark:hover:bg-neutral-600"},"Cancel"),e("button",{type:"submit",disabled:u.value,class:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[u.value?(a(),g("span",T,"Resetting...")):(a(),g("span",J,"Reset Password"))],8,H)])],32)])])]),_:1}))}},K={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm"},L={class:"relative z-50 bg-white dark:bg-neutral-800 p-6 rounded-lg shadow-xl border border-gray-200 dark:border-neutral-700 min-w-[400px] max-w-md mx-auto w-full"},Q={class:"mb-4"},W={class:"relative"},X=["type"],Y={key:0,class:"text-xs text-red-500 mt-1"},Z={class:"flex justify-end gap-2 mt-4"},ee=["disabled"],te={key:0,class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},le={__name:"PasswordVerificationModal",props:{modelValue:Boolean,loading:Boolean,error:{type:String,default:null}},emits:["update:modelValue","verify","cancel","success"],setup(d,{emit:k}){const h=d,y=k,l=c(""),m=c(!1),o=c(!1),u=M({password:""});z(()=>h.modelValue,i=>{i||(l.value="",u.reset())});function p(){if(!l.value){f.error("Please enter your admin password");return}m.value=!0,u.password=l.value,u.post("/settings/user-management/verify-password",{preserveScroll:!0,onSuccess:i=>{f.success("Password verification successful"),y("success",l.value),v()},onError:i=>{Object.values(i).flat().forEach(s=>{typeof s=="string"&&f.error(s)})},onFinish:()=>{m.value=!1}})}function v(){y("cancel"),y("update:modelValue",!1)}return(i,s)=>(a(),b(E,{"model-value":d.modelValue,"onUpdate:modelValue":s[2]||(s[2]=r=>i.$emit("update:modelValue",r))},{default:S(()=>[d.modelValue?(a(),g("div",K,[e("div",L,[s[5]||(s[5]=e("h2",{class:"text-lg font-bold mb-4 text-center"},"Verify Admin Password",-1)),s[6]||(s[6]=e("div",{class:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},[e("div",{class:"flex items-start"},[e("svg",{class:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("div",null,[e("h4",{class:"text-sm font-semibold text-blue-800 dark:text-blue-200 mb-1"},"Security Check"),e("p",{class:"text-xs text-blue-700 dark:text-blue-300"},"Please enter your admin password to view the user password.")])])],-1)),e("form",{onSubmit:j(p,["prevent"])},[e("div",Q,[s[3]||(s[3]=e("label",{class:"block text-sm font-medium mb-1"},"Admin Password",-1)),e("div",W,[P(e("input",{"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),type:o.value?"text":"password",class:"w-full px-3 py-2 rounded border border-gray-300 dark:border-neutral-600 dark:bg-neutral-800 dark:text-white focus:ring-2 focus:ring-blue-400 focus:border-blue-500 dark:focus:border-blue-400",autocomplete:"current-password"},null,8,X),[[V,l.value]]),e("button",{type:"button",onClick:s[1]||(s[1]=r=>o.value=!o.value),class:"absolute right-2 top-2 text-gray-500"},[o.value?(a(),b(w(_),{key:0,class:"h-5 w-5"})):(a(),b(w(C),{key:1,class:"h-5 w-5"}))])]),d.error?(a(),g("div",Y,$(d.error),1)):x("",!0)]),e("div",Z,[e("button",{onClick:v,type:"button",class:"px-4 py-2 rounded bg-gray-200 dark:bg-neutral-700 text-gray-700 dark:text-white hover:bg-gray-300 dark:hover:bg-neutral-600"},"Cancel"),e("button",{type:"submit",disabled:d.loading||!l.value,class:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[d.loading?(a(),g("svg",te,s[4]||(s[4]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):x("",!0),B(" "+$(d.loading?"Verifying...":"Verify"),1)],8,ee)])],32)])])):x("",!0)]),_:1},8,["model-value"]))}};export{ae as _,le as a};
