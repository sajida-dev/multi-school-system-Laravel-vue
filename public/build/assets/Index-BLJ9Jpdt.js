import{d as be,r as m,w as H,x as fe,c as X,y as ge,b as j,o as i,e as a,f as n,g as s,u as r,h as xe,k as p,i as d,z as G,n as J,_ as y,j as x,F as k,m as h,t as u,v as g,A as K,N as ve,E as ye,B as ke,C as he,D as _e,X as we,a as Ce,W as T,l as $}from"./app-oDzFbDpS.js";import{F as Pe,l as Se}from"./style-Dw9QIOcF.js";import{_ as je}from"./AppLayout.vue_vue_type_script_setup_true_lang-B8xcv65_.js";import{_ as Te}from"./BaseDataTable.vue_vue_type_style_index_0_lang-dE9UHpEE.js";import{_ as Ve}from"./DialogHeader.vue_vue_type_script_setup_true_lang-BpgOtXzy.js";import{P as Ae}from"./plus-DaPcSaFA.js";import{E as R}from"./eye-DjBiqAnr.js";import{E as De}from"./eye-off-ByIEJSqi.js";import{T as $e}from"./trash-Byk8sBRk.js";import{I as Y}from"./info-Cu4eEvQq.js";import{C as Ue}from"./circle-check-big-Dm6EHrTH.js";import{_ as Fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./RovingFocusGroup-CLnOwjDo.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DPNLz3sn.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cob2K5o9.js";import"./building-2-Dp0U14zc.js";import"./users-DDnJbTSp.js";import"./school-T4gwIvXC.js";import"./chevron-down-SN-issHr.js";import"./check-CEIiCWnz.js";const qe={class:"max-w-7xl mx-auto w-full px-2 sm:px-4 md:px-6 lg:px-8 py-8"},Be={class:"mb-6"},Me={class:"relative max-w-md"},Ee={class:"flex lg:hidden justify-between items-center mb-4 gap-3"},Ie={class:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4 mb-6 items-end hidden lg:grid"},Ne={class:"flex flex-col"},ze=["value"],Le={class:"flex flex-col"},Oe=["value"],Qe={class:"flex flex-col"},We=["value"],He={class:"flex flex-col"},Xe={class:"flex flex-col"},Ge={class:"sheet-content dark:bg-neutral-900"},Je={class:"mb-4"},Ke={class:"relative"},Re={class:"flex flex-col gap-4"},Ye={class:"flex flex-col"},Ze=["value"],et={class:"flex flex-col"},tt=["value"],st={class:"flex flex-col"},rt=["value"],lt={class:"flex flex-col"},ot={class:"font-medium text-gray-900 dark:text-gray-100"},at={class:"text-sm text-gray-500 dark:text-gray-400"},it={class:"text-gray-900 dark:text-gray-100"},nt={class:"font-medium"},dt={class:"text-sm text-gray-500 dark:text-gray-400"},ut={class:"text-gray-900 dark:text-gray-100"},pt={class:"text-gray-900 dark:text-gray-100"},ct={class:"text-gray-900 dark:text-gray-100"},mt={class:"text-gray-900 dark:text-gray-100"},bt={class:"text-gray-900 dark:text-gray-100"},ft=["onClick"],gt=["onClick","aria-label","title"],xt=["onClick"],vt={class:"flex gap-2 justify-end"},yt={class:"mb-6"},kt={class:"flex items-start gap-3 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800"},ht={class:"font-medium text-blue-900 dark:text-blue-100 mb-2"},_t=be({__name:"Index",props:{papers:{},classes:{},sections:{},teachers:{},filters:{}},setup(Z){var z,L,O,Q,W;const b=Z;console.log("props",b);const _=m([]),U=new Map,ee=m(""),te=m(""),se=[{title:"Papers & Questions",href:route("papersquestions.index")}];async function q(l){if(U.has(l)){_.value=U.get(l);return}try{const e=await Ce.get(`/api/classes/${l}/sections`);U.set(l,e.data),_.value=e.data}catch(e){console.error("Failed to load sections:",e),_.value=[]}}H(ee,l=>{te.value="",q(l)},{immediate:!0});const V=m(),re=()=>{var l;(l=V==null?void 0:V.value)==null||l.open()},o=fe({search:((z=b.filters)==null?void 0:z.search)||"",class_id:((L=b.filters)==null?void 0:L.class_id)||"",section_id:((O=b.filters)==null?void 0:O.section_id)||"",teacher_id:((Q=b.filters)==null?void 0:Q.teacher_id)||"",published:((W=b.filters)==null?void 0:W.published)||""}),le=m(!1),B=m({page:b.papers.current_page,rowsPerPage:b.papers.per_page,sortBy:"",sortType:"",search:"",filters:{}}),oe=X(()=>b.papers.total),ae=[{text:"#",value:"id"},{text:"Title",value:"title"},{text:"Class/Section",value:"class_section"},{text:"Subject",value:"subject"},{text:"Teacher",value:"teacher"},{text:"Duration",value:"duration"},{text:"Total Marks",value:"total_marks"},{text:"Questions",value:"questions_count"},{text:"Status",value:"published"},{text:"Actions",value:"actions",sortable:!1}],ie=X(()=>b.papers.data.map(l=>({id:l.id,title:l.title,class:l.class,section:l.section,subject:l.subject,teacher:l.teacher,published:l.published,questions_count:l.questions_count,total_marks:l.total_marks,time_duration:l.time_duration}))),v=m(!1),w=m(null),C=m(!1),A=m(""),P=m(null);function F(){o.get(route("papersquestions.index"),{preserveState:!0,preserveScroll:!0,replace:!0})}let D;["search","class_id","section_id","teacher_id","published"].forEach(l=>{H(()=>o[l],()=>{clearTimeout(D),D=setTimeout(()=>{F()},500)})});function ne(l){T.visit(route("papersquestions.show",l))}function M(){T.visit(route("papersquestions.create"))}function E(l){clearTimeout(D),D=setTimeout(()=>{F()},500)}function I(){o.search="",F()}function de(l){w.value=l,v.value=!0}function N(){w.value&&T.delete(route("papersquestions.destroy",w.value),{onSuccess:()=>{$.success("Paper deleted successfully"),v.value=!1,w.value=null},onError:()=>{$.error("Failed to delete paper"),v.value=!1,w.value=null}})}function ue(l,e){const f=e?"unpublish":"publish",t=`Are you sure you want to ${f} this paper?`;pe(t,()=>{T.patch(route("papersquestions.toggle-publish",l),{},{onSuccess:()=>{$.success(`Paper ${f}ed successfully`),T.visit(route("papersquestions.index"),{only:["papers"],preserveState:!0,preserveScroll:!0,replace:!0})},onError:()=>{$.error(`Failed to ${f} paper`)}})})}function pe(l,e){A.value=l,P.value=e,C.value=!0}function ce(){P.value&&P.value(),C.value=!1,A.value="",P.value=null}function me(){C.value=!1,A.value="",P.value=null}return(l,e)=>{const f=ge("can");return i(),j(je,{breadcrumbs:se},{default:a(()=>[n(r(xe),{title:"Papers & Questions"}),s("div",qe,[e[45]||(e[45]=s("h1",{class:"text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100"},"Papers & Questions",-1)),s("div",Be,[s("div",Me,[e[16]||(e[16]=s("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[s("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),p(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r(o).search=t),type:"text",placeholder:"Search papers by title...",class:"block w-full pl-10 pr-10 py-2.5 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-neutral-900 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200 text-sm",onInput:E},null,544),[[J,r(o).search]]),r(o).search?(i(),d("button",{key:0,onClick:I,class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors"},e[15]||(e[15]=[s("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):G("",!0)])]),s("div",Ee,[p((i(),j(y,{variant:"default",class:"h-10",onClick:M},{default:a(()=>[n(r(Ae),{class:"w-4 h-4 mr-2"}),e[17]||(e[17]=x(" Add Paper "))]),_:1,__:[17]})),[[f,"create-papers"]]),s("button",{onClick:re,class:"flex items-center gap-2 p-2 rounded-full bg-primary-100 dark:bg-primary-900 hover:bg-primary-200 dark:hover:bg-primary-800 shadow transition",title:"Show filters for paper records"},[n(r(Pe),{class:"w-6 h-6 text-primary-700 dark:text-primary-200"}),e[18]||(e[18]=s("span",{class:"text-primary-700 dark:text-primary-200 font-medium text-base"},"Filters",-1))])]),s("div",Ie,[s("div",Ne,[e[20]||(e[20]=s("label",{for:"class_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},"Class",-1)),p(s("select",{id:"class_id","onUpdate:modelValue":e[1]||(e[1]=t=>r(o).class_id=t),onChange:e[2]||(e[2]=t=>q(r(o).class_id)),class:"w-full border border-gray-300 dark:border-gray-600 rounded px-2 py-1.5 bg-white dark:bg-neutral-900"},[e[19]||(e[19]=s("option",{value:""},"All",-1)),(i(!0),d(k,null,h(l.classes,t=>(i(),d("option",{key:t.id,value:t.id},u(t.name),9,ze))),128))],544),[[g,r(o).class_id]])]),s("div",Le,[e[22]||(e[22]=s("label",{for:"section_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},"Section",-1)),p(s("select",{id:"section_id","onUpdate:modelValue":e[3]||(e[3]=t=>r(o).section_id=t),class:"w-full border border-gray-300 dark:border-gray-600 rounded px-2 py-1.5 bg-white dark:bg-neutral-900"},[e[21]||(e[21]=s("option",{value:""},"All",-1)),(i(!0),d(k,null,h(_.value,t=>(i(),d("option",{key:t.id,value:t.id},u(t.name),9,Oe))),128))],512),[[g,r(o).section_id]])]),s("div",Qe,[e[24]||(e[24]=s("label",{for:"teacher_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},"Teacher",-1)),p(s("select",{id:"teacher_id","onUpdate:modelValue":e[4]||(e[4]=t=>r(o).teacher_id=t),class:"w-full border border-gray-300 dark:border-gray-600 rounded px-2 py-1.5 bg-white dark:bg-neutral-900"},[e[23]||(e[23]=s("option",{value:""},"All",-1)),(i(!0),d(k,null,h(l.teachers,t=>(i(),d("option",{key:t.id,value:t.id},u(t.name),9,We))),128))],512),[[g,r(o).teacher_id]])]),s("div",He,[e[26]||(e[26]=s("label",{for:"published",class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},"Status",-1)),p(s("select",{id:"published","onUpdate:modelValue":e[5]||(e[5]=t=>r(o).published=t),class:"w-full border border-gray-300 dark:border-gray-600 rounded px-2 py-1.5 bg-white dark:bg-neutral-900"},e[25]||(e[25]=[s("option",{value:""},"All",-1),s("option",{value:"1"},"Published",-1),s("option",{value:"0"},"Draft",-1)]),512),[[g,r(o).published]])]),s("div",Xe,[p((i(),j(y,{variant:"default",class:"h-10",onClick:M},{default:a(()=>e[27]||(e[27]=[x("Add Paper")])),_:1,__:[27]})),[[f,"create-papers"]])])]),n(r(Se),{overlay:!0,"can-swipe":!0,"overlay-click-close":!0,"transition-duration":.5,ref_key:"myBottomSheet",ref:V,class:"dark:bg-neutral-900"},{default:a(()=>[s("div",Ge,[e[38]||(e[38]=s("h2",{class:"text-lg font-semibold mb-4"},"Paper Filters",-1)),s("div",Je,[s("div",Ke,[e[29]||(e[29]=s("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[s("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),p(s("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>r(o).search=t),type:"text",placeholder:"Search papers by title...",class:"block w-full pl-10 pr-10 py-2.5 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-neutral-900 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200 text-sm",onInput:E},null,544),[[J,r(o).search]]),r(o).search?(i(),d("button",{key:0,onClick:I,class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors"},e[28]||(e[28]=[s("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):G("",!0)])]),s("div",Re,[s("div",Ye,[e[31]||(e[31]=s("label",{for:"class_id-mobile",class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},"Class",-1)),p(s("select",{id:"class_id-mobile","onUpdate:modelValue":e[7]||(e[7]=t=>r(o).class_id=t),class:"w-full border border-gray-300 dark:border-gray-600 rounded px-2 py-1 bg-white dark:bg-neutral-900"},[e[30]||(e[30]=s("option",{value:""},"All",-1)),(i(!0),d(k,null,h(l.classes,t=>(i(),d("option",{key:t.id,value:t.id},u(t.name),9,Ze))),128))],512),[[g,r(o).class_id]])]),s("div",et,[e[33]||(e[33]=s("label",{for:"section_id-mobile",class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},"Section",-1)),p(s("select",{id:"section_id-mobile","onUpdate:modelValue":e[8]||(e[8]=t=>r(o).section_id=t),class:"w-full border border-gray-300 dark:border-gray-600 rounded px-2 py-1 bg-white dark:bg-neutral-900"},[e[32]||(e[32]=s("option",{value:""},"All",-1)),(i(!0),d(k,null,h(_.value,t=>(i(),d("option",{key:t.id,value:t.id},u(t.name),9,tt))),128))],512),[[g,r(o).section_id]])]),s("div",st,[e[35]||(e[35]=s("label",{for:"teacher_id-mobile",class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},"Teacher",-1)),p(s("select",{id:"teacher_id-mobile","onUpdate:modelValue":e[9]||(e[9]=t=>r(o).teacher_id=t),class:"w-full border border-gray-300 dark:border-gray-600 rounded px-2 py-1 bg-white dark:bg-neutral-900"},[e[34]||(e[34]=s("option",{value:""},"All",-1)),(i(!0),d(k,null,h(l.teachers,t=>(i(),d("option",{key:t.id,value:t.id},u(t.name),9,rt))),128))],512),[[g,r(o).teacher_id]])]),s("div",lt,[e[37]||(e[37]=s("label",{for:"published-mobile",class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},"Status",-1)),p(s("select",{id:"published-mobile","onUpdate:modelValue":e[10]||(e[10]=t=>r(o).published=t),class:"w-full border border-gray-300 dark:border-gray-600 rounded px-2 py-1 bg-white dark:bg-neutral-900"},e[36]||(e[36]=[s("option",{value:""},"All",-1),s("option",{value:"1"},"Published",-1),s("option",{value:"0"},"Draft",-1)]),512),[[g,r(o).published]])])])])]),_:1},512),n(Te,{headers:ae,items:ie.value,loading:le.value,"server-options":B.value,"server-items-length":oe.value,"onUpdate:serverOptions":e[11]||(e[11]=t=>Object.assign(B.value,t)),"table-class":"bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg shadow-md hover:shadow-lg transition-all min-w-full","row-class":"hover:bg-purple-50 dark:hover:bg-purple-900/60 transition cursor-pointer border-b border-neutral-100 dark:border-neutral-800"},{"item-title":a(t=>{var c;return[s("div",ot,u(t.title),1),s("div",at,u(((c=t.subject)==null?void 0:c.name)||"No Subject"),1)]}),"item-class_section":a(t=>{var c,S;return[s("div",it,[s("div",nt,u(((c=t.class)==null?void 0:c.name)||"-"),1),s("div",dt,u(((S=t.section)==null?void 0:S.name)||"No Section"),1)])]}),"item-subject":a(t=>{var c;return[s("span",ut,u(((c=t.subject)==null?void 0:c.name)||"-"),1)]}),"item-teacher":a(t=>{var c,S;return[s("span",pt,u(((S=(c=t.teacher)==null?void 0:c.user)==null?void 0:S.name)||"-"),1)]}),"item-duration":a(t=>[s("span",ct,u(t.time_duration||0)+" min",1)]),"item-total_marks":a(t=>[s("span",mt,u(t.total_marks||0)+" marks",1)]),"item-questions_count":a(t=>[s("span",bt,u(t.questions_count||0)+" questions",1)]),"item-published":a(t=>[s("span",{class:K({"inline-block rounded-full px-2 py-0.5 text-xs font-semibold":!0,"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":t.published,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":!t.published})},u(t.published?"Published":"Draft"),3)]),"item-actions":a(t=>[p((i(),d("button",{class:"inline-flex items-center justify-center rounded-full p-2 text-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-400 mr-1",onClick:c=>ne(t.id),"aria-label":"View Paper",title:"View Paper"},[n(r(R),{class:"w-5 h-5"})],8,ft)),[[f,"read-papers"]]),p((i(),d("button",{class:K(["inline-flex items-center justify-center rounded-full p-2 mr-1 focus:outline-none focus:ring-2",t.published?"text-orange-500 focus:ring-orange-400":"text-green-500 focus:ring-green-400"]),onClick:c=>ue(t.id,t.published),"aria-label":t.published?"Unpublish Paper":"Publish Paper",title:t.published?"Unpublish Paper":"Publish Paper"},[t.published?(i(),j(r(De),{key:0,class:"w-5 h-5"})):(i(),j(r(R),{key:1,class:"w-5 h-5"}))],10,gt)),[[f,"publish-papers"]]),p((i(),d("button",{class:"inline-flex items-center justify-center rounded-full p-2 text-red-500 focus:outline-none focus:ring-2 focus:ring-red-400",onClick:c=>de(t.id),"aria-label":"Delete Paper",title:"Delete Paper"},[n(r($e),{class:"w-5 h-5"})],8,xt)),[[f,"delete-papers"]])]),_:1},8,["items","loading","server-options","server-items-length"]),n(ve,{modelValue:v.value,"onUpdate:modelValue":e[13]||(e[13]=t=>v.value=t),title:"Delete Paper",message:"Are you sure you want to delete this paper? This action cannot be undone.","confirm-text":"Delete","cancel-text":"Cancel",onConfirm:N},{footer:a(()=>[s("div",vt,[n(y,{variant:"outline",onClick:e[12]||(e[12]=t=>v.value=!1)},{default:a(()=>e[39]||(e[39]=[x("Cancel")])),_:1,__:[39]}),n(y,{variant:"destructive",onClick:N},{default:a(()=>e[40]||(e[40]=[x("Delete")])),_:1,__:[40]})])]),_:1},8,["modelValue"]),n(r(ye),{open:C.value,"onUpdate:open":e[14]||(e[14]=t=>C.value=t)},{default:a(()=>[n(r(ke),{class:"sm:max-w-md max-w-[95vw] mx-4"},{default:a(()=>[n(r(Ve),null,{default:a(()=>[n(r(he),{class:"flex items-center gap-2"},{default:a(()=>[n(r(Y),{class:"w-5 h-5 text-blue-600"}),e[41]||(e[41]=x(" Confirm Action "))]),_:1,__:[41]})]),_:1}),s("div",yt,[s("div",kt,[n(r(Y),{class:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),s("div",null,[s("p",ht,u(A.value),1),e[42]||(e[42]=s("p",{class:"text-sm text-blue-700 dark:text-blue-300"}," This action cannot be undone. ",-1))])])]),n(r(_e),{class:"flex flex-col sm:flex-row gap-3"},{default:a(()=>[n(y,{variant:"outline",onClick:me,class:"w-full sm:w-auto px-6 py-3 text-base"},{default:a(()=>[n(r(we),{class:"w-4 h-4 mr-2"}),e[43]||(e[43]=x(" Cancel "))]),_:1,__:[43]}),n(y,{variant:"default",onClick:ce,class:"w-full sm:w-auto px-6 py-3 text-base"},{default:a(()=>[n(r(Ue),{class:"w-4 h-4 mr-2"}),e[44]||(e[44]=x(" Confirm "))]),_:1,__:[44]})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1})}}}),Qt=Fe(_t,[["__scopeId","data-v-be66769c"]]);export{Qt as default};
