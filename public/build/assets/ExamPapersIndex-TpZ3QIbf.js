import{d as Q,r as n,w as j,x as R,y as X,b as U,o as E,e as i,f as r,g as p,u as t,h as Y,k as y,_ as b,j as o,i as M,A as Z,t as m,E as N,B as T,C as q,p as w,D as A,l as _,W as V}from"./app-0hD9jktS.js";import{_ as h}from"./BaseDataTable.vue_vue_type_style_index_0_lang-CTigQWSr.js";import{_ as B}from"./DialogHeader.vue_vue_type_script_setup_true_lang-DOJjbuxF.js";import{_ as I}from"./Icon.vue_vue_type_script_setup_true_lang-DgG5U0yt.js";import{_ as ee}from"./ManageLayout.vue_vue_type_script_setup_true_lang-Cx7tEqqw.js";import{_ as D,a as v}from"./SelectInput-C8qFFp1m.js";import"./loader-circle-Dg-d1WoA.js";import"./chevron-down-Bc9-FnA7.js";import"./check-DytFQTDT.js";import"./building-2-0J7JWYjO.js";import"./target-nv-k3IQz.js";import"./triangle-alert-dLAnWNBM.js";import"./refresh-cw-DBp2ONfo.js";import"./save-DvCxJJrq.js";import"./plus-DX8dkZyx.js";import"./arrow-right-yGz9ZWmd.js";import"./arrow-left-B5cZ3DqQ.js";import"./eye-off-B84CHv0x.js";import"./eye-Dtz9j6o0.js";import"./shield-BxF9Ptyz.js";import"./square-pen-QEAPgpV6.js";import"./info-DWKpZpD6.js";import"./calendar-DjniW4jB.js";import"./house-D65vkcx-.js";import"./book-open-Dculjk7S.js";import"./trash-hGn8IamB.js";import"./users-CQiJNf1m.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-C_OfVMdc.js";import"./RovingFocusGroup-BrsbekXI.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DLhJV-ve.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DV00-4L5.js";import"./school-SWVnhMs_.js";import"./clipboard-list-CVjOUuc6.js";import"./Label.vue_vue_type_script_setup_true_lang-CLv8w6I-.js";import"./Input.vue_vue_type_script_setup_true_lang-ByoFr_iA.js";import"./InputError.vue_vue_type_script_setup_true_lang-BnFbo3YU.js";const ae={class:"max-w-6xl mx-auto w-full px-2 sm:px-4 md:px-0 py-8"},te={class:"flex justify-between items-center mb-6"},le=["onClick"],re=["disabled","title","onClick"],se={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ge=Q({__name:"ExamPapersIndex",props:{examPapers:{},exams:{},papers:{},subjects:{}},setup(z){const d=z,C=n([...d.examPapers]),$=n([...d.exams]),S=n([...d.papers]);j(()=>d.examPapers,s=>C.value=[...s]),j(()=>d.exams,s=>$.value=[...s]),j(()=>d.papers,s=>S.value=[...s]);const x=n(!1),f=n(!1),k=n(null),c=n(!1),g=n(null),a=R({exam_id:void 0,paper_id:void 0,subject_id:void 0,exam_date:"",start_time:"",end_time:"",total_marks:100,passing_marks:40}),W=[{text:"ID",value:"id"},{text:"Exam",value:"exam_title",slotName:"item-exam_title"},{text:"Paper",value:"paper_name",slotName:"item-paper_name"},{text:"Subject",value:"subject_name",slotName:"item-subject_name"},{text:"Date",value:"exam_date"},{text:"Time",value:"time_range",slotName:"item-time_range"},{text:"Marks (Passing/Total)",value:"marks",slotName:"item-marks"},{text:"Actions",value:"actions",sortable:!1,slotName:"item-actions"}];function F(){f.value=!1,k.value=null,a.reset(),a.clearErrors(),x.value=!0}function O(s){var l,u,e;f.value=!0,k.value=s,a.reset(),a.exam_id=s.exam_id??((l=s.exam)==null?void 0:l.id)??null,a.paper_id=s.paper_id??((u=s.paper)==null?void 0:u.id)??null,a.subject_id=s.subject_id??((e=s.subject)==null?void 0:e.id)??null,a.exam_date=s.exam_date,a.start_time=s.start_time??"",a.end_time=s.end_time??"",a.total_marks=s.total_marks,a.passing_marks=s.passing_marks,a.clearErrors(),x.value=!0}function P(){x.value=!1,a.reset(),a.clearErrors()}function G(){var s;f.value&&((s=k.value)!=null&&s.id)?a.put(`/exam-papers/${k.value.id}`,{onSuccess:()=>{_.success("Exam paper updated!"),P(),V.reload({only:["examPapers"]})},onError:()=>_.error("Validation failed.")}):a.post("/exam-papers",{onSuccess:()=>{_.success("Exam paper created!"),P(),V.reload({only:["examPapers"]})},onError:()=>_.error("Validation failed.")})}function H(s){g.value=s.value,c.value=!0}function J(){g.value&&(console.log("itemToDelete.value",g.value),a.processing=!0,V.delete(`/exam-papers/${g.value.id}`,{onSuccess:()=>{_.success("Exam paper deleted!"),c.value=!1,V.reload({only:["examPapers"]})},onError:()=>_.error("Deletion failed!"),onFinish:()=>a.processing=!1}))}function K(){c.value=!1}return(s,l)=>{const u=X("can");return E(),U(ee,null,{default:i(()=>[r(t(Y),{title:"Exam Papers"}),p("div",ae,[p("div",te,[l[11]||(l[11]=p("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100"},"Exam Papers",-1)),y((E(),U(t(b),{variant:"default",size:"lg",onClick:F},{default:i(()=>l[10]||(l[10]=[o(" Add Exam Paper ")])),_:1,__:[10]})),[[u,"create-exam-papers"]])]),r(h,{headers:W,items:C.value,loading:t(a).processing,class:"bg-white dark:bg-neutral-900 rounded-xl shadow border border-gray-200 dark:border-neutral-700"},{"item-exam_title":i(e=>[o(m(e.exam.title),1)]),"item-paper_name":i(e=>[o(m(e.paper.title),1)]),"item-subject_name":i(e=>[o(m(e.subject.name),1)]),"item-exam_date":i(e=>[o(m(e.exam_date),1)]),"item-time_range":i(e=>[o(m(e.start_time??"—")+" – "+m(e.end_time??"—"),1)]),"item-marks":i(e=>[o(m(e.passing_marks)+" / "+m(e.total_marks),1)]),"item-actions":i(e=>[y((E(),M("button",{class:"inline-flex items-center justify-center rounded-full p-2 text-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-400 mr-1",onClick:L=>O(e),title:"Edit","aria-label":"Edit Exam Paper"},[r(I,{name:"edit",class:"w-5 h-5"})],8,le)),[[u,"update-exam-papers"]]),y((E(),M("button",{disabled:!e.can_be_deleted,class:Z(["inline-flex items-center justify-center rounded-full p-2",e.can_be_deleted?"text-red-500 focus:ring-2 focus:ring-red-400":"text-red-300 cursor-not-allowed"]),title:e.can_be_deleted?"Delete Exam Paper":`${e.exam_results_count} result(s) linked. Cannot delete.`,onClick:L=>e.can_be_deleted&&H(e),"aria-label":"Delete Exam Paper"},[r(I,{name:"trash",class:"w-5 h-5"})],10,re)),[[u,"delete-exam-papers"]])]),_:1},8,["items","loading"])]),r(t(N),{open:x.value,"onUpdate:open":l[8]||(l[8]=e=>x.value=e)},{default:i(()=>[r(t(T),null,{default:i(()=>[r(t(B),null,{default:i(()=>[r(t(q),null,{default:i(()=>[o(m(f.value?"Edit Exam Paper":"Add Exam Paper"),1)]),_:1})]),_:1}),p("form",{onSubmit:w(G,["prevent"]),class:"space-y-6"},[r(D,{id:"exam_id",modelValue:t(a).exam_id,"onUpdate:modelValue":l[0]||(l[0]=e=>t(a).exam_id=e),label:"Exam",required:"",options:$.value.map(e=>({label:e.title,value:e.id})),placeholder:"Select Exam",error:t(a).errors.exam_id},null,8,["modelValue","options","error"]),r(D,{id:"paper_id",modelValue:t(a).paper_id,"onUpdate:modelValue":l[1]||(l[1]=e=>t(a).paper_id=e),label:"Paper",required:"",options:S.value.map(e=>({label:e.title,value:e.id})),placeholder:"Select Paper",error:t(a).errors.paper_id},null,8,["modelValue","options","error"]),p("div",se,[r(D,{id:"subject_id",modelValue:t(a).subject_id,"onUpdate:modelValue":l[2]||(l[2]=e=>t(a).subject_id=e),label:"Subject",required:"",options:s.subjects.map(e=>({label:e.name,value:e.id})),placeholder:"Select Subject",error:t(a).errors.subject_id},null,8,["modelValue","options","error"]),r(v,{id:"exam_date",modelValue:t(a).exam_date,"onUpdate:modelValue":l[3]||(l[3]=e=>t(a).exam_date=e),label:"Exam Date",type:"date",required:"",error:t(a).errors.exam_date},null,8,["modelValue","error"]),r(v,{id:"start_time",modelValue:t(a).start_time,"onUpdate:modelValue":l[4]||(l[4]=e=>t(a).start_time=e),label:"Start Time",type:"time",required:"",error:t(a).errors.start_time},null,8,["modelValue","error"]),r(v,{id:"end_time",modelValue:t(a).end_time,"onUpdate:modelValue":l[5]||(l[5]=e=>t(a).end_time=e),label:"End Time",type:"time",required:"",error:t(a).errors.end_time},null,8,["modelValue","error"]),r(v,{id:"total_marks",modelValue:t(a).total_marks,"onUpdate:modelValue":l[6]||(l[6]=e=>t(a).total_marks=e),modelModifiers:{number:!0},label:"Total Marks",type:"number",required:"",error:t(a).errors.total_marks},null,8,["modelValue","error"]),r(v,{id:"passing_marks",modelValue:t(a).passing_marks,"onUpdate:modelValue":l[7]||(l[7]=e=>t(a).passing_marks=e),modelModifiers:{number:!0},label:"Passing Marks",required:"",type:"number",error:t(a).errors.passing_marks},null,8,["modelValue","error"])]),r(t(A),{class:"mt-4"},{default:i(()=>[r(t(b),{type:"button",variant:"outline",onClick:P},{default:i(()=>l[12]||(l[12]=[o("Cancel")])),_:1,__:[12]}),r(t(b),{type:"submit",disabled:t(a).processing},{default:i(()=>[o(m(f.value?"Update":"Create"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),r(t(N),{open:c.value,"onUpdate:open":l[9]||(l[9]=e=>c.value=e)},{default:i(()=>[r(t(T),null,{default:i(()=>[r(t(B),null,{default:i(()=>[r(t(q),null,{default:i(()=>l[13]||(l[13]=[o("Delete Exam Paper?")])),_:1,__:[13]})]),_:1}),l[16]||(l[16]=p("div",{class:"mb-4"},"Are you sure you want to delete this exam paper? This cannot be undone.",-1)),r(t(A),null,{default:i(()=>[r(t(b),{variant:"outline",onClick:K},{default:i(()=>l[14]||(l[14]=[o("Cancel")])),_:1,__:[14]}),r(t(b),{variant:"destructive",onClick:J},{default:i(()=>l[15]||(l[15]=[o("Delete")])),_:1,__:[15]})]),_:1})]),_:1,__:[16]})]),_:1},8,["open"])]),_:1})}}});export{Ge as default};
