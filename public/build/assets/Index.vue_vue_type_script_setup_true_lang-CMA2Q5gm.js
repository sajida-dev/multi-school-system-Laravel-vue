import{d as O,r,w as Z,y as G,i as k,o as g,f as n,g as d,u as l,h as H,k as D,b as J,e as s,j as u,_ as p,B as w,C as E,t as A,p as K,D as h,E as F,F as L,W as c,l as x}from"./app-oDzFbDpS.js";import{_ as P}from"./BaseDataTable.vue_vue_type_style_index_0_lang-dE9UHpEE.js";import{_ as Q}from"./Label.vue_vue_type_script_setup_true_lang-BphRAz40.js";import{_ as R}from"./Input.vue_vue_type_script_setup_true_lang-CJXbLAqT.js";import{_ as X}from"./InputError.vue_vue_type_script_setup_true_lang-DL9oimPF.js";import{_ as N}from"./DialogHeader.vue_vue_type_script_setup_true_lang-BpgOtXzy.js";import{_ as U}from"./Icon.vue_vue_type_script_setup_true_lang-CktM08l_.js";const Y={class:"max-w-4xl mx-auto w-full px-2 sm:px-4 md:px-0 py-8"},ee={class:"flex justify-between items-center mb-6"},te=["onClick"],ne=["onClick"],ae={class:"mb-4 flex flex-col gap-2"},ce=O({__name:"Index",props:{sections:{}},setup(V){const S=V,$=r(S.sections?[...S.sections]:[]);Z(()=>S.sections,t=>{$.value=t?[...t]:[]});const o=r(!1),m=r(!1),f=r(!1),b=r(null),v=r(!1),_=r(null),a=r({name:"",errors:{name:""}}),B=[{text:"ID",value:"id"},{text:"Section Name",value:"name"},{text:"Actions",value:"actions",sortable:!1,slotName:"item-actions"}];function j(){f.value=!1,a.value.name="",a.value.errors.name="",m.value=!0}function M(t){f.value=!0,b.value=t,a.value.name=t.name,a.value.errors.name="",m.value=!0}function y(){m.value=!1,a.value.name="",a.value.errors.name="",b.value=null}async function T(){o.value=!0,a.value.errors.name="";try{f.value&&b.value?c.put(`/sections/${b.value.id}`,{name:a.value.name},{onSuccess:()=>{x.success("Section updated!"),y(),c.reload({only:["sections"]})},onError:t=>{t.name?a.value.errors.name=t.name:typeof t=="string"?a.value.errors.name=t:a.value.errors.name="Update failed.",console.error("Update errors:",t)},onFinish:()=>{o.value=!1}}):c.post("/sections",{name:a.value.name},{onSuccess:()=>{x.success("Section created!"),y(),c.reload({only:["sections"]})},onError:t=>{t.name?a.value.errors.name=t.name:typeof t=="string"?a.value.errors.name=t:a.value.errors.name="Creation failed.",console.error("Creation errors:",t)},onFinish:()=>{o.value=!1}})}catch(t){console.error("Error in handleSubmit:",t),x.error("An error occurred."),o.value=!1}}function I(t){_.value=t,v.value=!0}async function W(){_.value&&(o.value=!0,c.delete(`/sections/${_.value.id}`,{onSuccess:()=>{x.success("Section deleted!"),v.value=!1,_.value=null,c.reload({only:["sections"]})},onError:()=>{x.error("Failed to delete section.")},onFinish:()=>{o.value=!1}}))}function q(){v.value=!1,_.value=null}return(t,e)=>{const C=G("can");return g(),k(L,null,[n(l(H),{title:"Sections"}),d("div",Y,[d("div",ee,[e[4]||(e[4]=d("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100"},"Sections",-1)),D((g(),J(l(p),{variant:"default",size:"lg",class:"mr-2",onClick:j},{default:s(()=>e[3]||(e[3]=[u("Add Section")])),_:1,__:[3]})),[[C,"create-sections"]])]),n(P,{headers:B,items:$.value,loading:o.value,class:"bg-white dark:bg-neutral-900 rounded-xl shadow border border-gray-200 dark:border-neutral-700"},{"item-actions":s(i=>[D((g(),k("button",{class:"inline-flex items-center justify-center rounded-full p-2 text-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-400 mr-1",onClick:z=>M(i),"aria-label":"Edit Section",title:"Edit Section"},[n(U,{name:"edit",class:"w-5 h-5"})],8,te)),[[C,"update-sections"]]),D((g(),k("button",{class:"inline-flex items-center justify-center rounded-full p-2 text-red-500 focus:outline-none focus:ring-2 focus:ring-red-400",onClick:z=>I(i),"aria-label":"Delete Section",title:"Delete Section"},[n(U,{name:"trash",class:"w-5 h-5"})],8,ne)),[[C,"delete-sections"]])]),_:1},8,["items","loading"])]),n(l(F),{open:m.value,"onUpdate:open":e[1]||(e[1]=i=>m.value=i)},{default:s(()=>[n(l(w),null,{default:s(()=>[n(l(N),null,{default:s(()=>[n(l(E),null,{default:s(()=>[u(A(f.value?"Edit Section":"Add Section"),1)]),_:1})]),_:1}),d("form",{onSubmit:K(T,["prevent"])},[d("div",ae,[n(l(Q),{for:"name"},{default:s(()=>e[5]||(e[5]=[u("Section Name")])),_:1,__:[5]}),n(l(R),{id:"name",modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=i=>a.value.name=i),type:"text",maxlength:"1",required:"",placeholder:"A"},null,8,["modelValue"]),n(X,{message:a.value.errors.name},null,8,["message"]),e[6]||(e[6]=d("p",{class:"text-xs text-gray-500"},"Enter a single letter (A-Z)",-1))]),n(l(h),null,{default:s(()=>[n(l(p),{type:"button",variant:"outline",onClick:y},{default:s(()=>e[7]||(e[7]=[u("Cancel")])),_:1,__:[7]}),n(l(p),{disabled:o.value},{default:s(()=>[u(A(f.value?"Update":"Create"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),n(l(F),{open:v.value,"onUpdate:open":e[2]||(e[2]=i=>v.value=i)},{default:s(()=>[n(l(w),null,{default:s(()=>[n(l(N),null,{default:s(()=>[n(l(E),null,{default:s(()=>e[8]||(e[8]=[u("Delete Section?")])),_:1,__:[8]})]),_:1}),e[11]||(e[11]=d("div",{class:"mb-4"},"Are you sure you want to delete this section? This action cannot be undone.",-1)),n(l(h),null,{default:s(()=>[n(l(p),{variant:"outline",onClick:q},{default:s(()=>e[9]||(e[9]=[u("Cancel")])),_:1,__:[9]}),n(l(p),{variant:"destructive",onClick:W},{default:s(()=>e[10]||(e[10]=[u("Delete")])),_:1,__:[10]})]),_:1})]),_:1,__:[11]})]),_:1},8,["open"])],64)}}});export{ce as _};
