import{d as G,r as u,w as S,x as H,y as J,b as q,o as c,e as r,f as l,g as o,u as a,h as Q,k as b,_ as g,j as d,i as x,A as w,t as m,E as A,B as F,C as M,p as R,z as j,F as X,m as Z,K as ee,n as te,D as ae,l as k,W as E}from"./app-0hD9jktS.js";import{_ as se}from"./BaseDataTable.vue_vue_type_style_index_0_lang-CTigQWSr.js";import{_ as B}from"./DialogHeader.vue_vue_type_script_setup_true_lang-DOJjbuxF.js";import{_ as le,a as $}from"./SelectInput-C8qFFp1m.js";import{_ as re}from"./ManageLayout.vue_vue_type_script_setup_true_lang-Cx7tEqqw.js";import{S as ne}from"./square-pen-QEAPgpV6.js";import{T as oe}from"./trash-hGn8IamB.js";import"./Label.vue_vue_type_script_setup_true_lang-CLv8w6I-.js";import"./Input.vue_vue_type_script_setup_true_lang-ByoFr_iA.js";import"./InputError.vue_vue_type_script_setup_true_lang-BnFbo3YU.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-C_OfVMdc.js";import"./RovingFocusGroup-BrsbekXI.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DLhJV-ve.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DV00-4L5.js";import"./building-2-0J7JWYjO.js";import"./users-CQiJNf1m.js";import"./school-SWVnhMs_.js";import"./chevron-down-Bc9-FnA7.js";import"./check-DytFQTDT.js";import"./clipboard-list-CVjOUuc6.js";import"./loader-circle-Dg-d1WoA.js";const de={class:"max-w-6xl mx-auto w-full px-2 sm:px-4 md:px-0 py-8"},ie={class:"flex justify-between items-center mb-6"},ue=["onClick"],me=["disabled","title","onClick"],ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},_e={class:"md:col-span-2"},pe={class:"flex flex-wrap gap-3"},xe=["value"],fe={key:0,class:"text-red-500 text-sm mt-1"},ve={class:"md:col-span-2"},ye={key:0,class:"text-red-500 text-sm mt-1"},be={class:"flex justify-end space-x-3"},Oe=G({__name:"ExamsIndex",props:{exams:{},examTypes:{},classes:{}},setup(I){const p=I,T=u([...p.exams]),h=u([...p.examTypes]),N=u([...p.classes]);u([]),S(()=>p.exams,n=>T.value=[...n]),S(()=>p.examTypes,n=>h.value=[...n]),S(()=>p.classes,n=>N.value=[...n]);const _=u(!1),f=u(!1),v=u(!1),U=u(null),y=u(!1),C=u(null),e=H({id:null,exam_type_id:"",class_id:"",class_ids:[],academic_year:"",start_date:"",end_date:"",instructions:""}),z=[{text:"ID",value:"id"},{text:"Title",value:"title"},{text:"Type",value:"exam_type_name",sortable:!1,slotName:"item-exam_type_name"},{text:"Class",value:"class_name",sortable:!1,slotName:"item-class_name"},{text:"Section",value:"section_name",sortable:!1,slotName:"item-section_name"},{text:"Dates",value:"dates",sortable:!1,slotName:"item-dates"},{text:"Status",value:"status"},{text:"Actions",value:"actions",sortable:!1,slotName:"item-actions"}];function O(){v.value=!1,U.value=null,e.reset(),f.value=!0}function W(n){v.value=!0,U.value=n,e.reset(),e.id=n.id,e.exam_type_id=n.exam_type.id??"",e.class_id=n.class_id,e.academic_year=n.academic_year,e.start_date=n.start_date,e.end_date=n.end_date,e.instructions=n.instructions??"",f.value=!0}function D(){f.value=!1}function K(){_.value=!0,e.exam_type_id===""||e.exam_type_id,e.class_ids.length>0&&e.class_ids,e.academic_year,e.start_date,e.end_date,e.instructions,v.value&&e.id!==null?e.put(`/exams/${e.id}`,{preserveScroll:!0,onSuccess:()=>{k.success("Exam updated!"),D(),E.reload({only:["exams"]})},onError:()=>{},onFinish:()=>{_.value=!1}}):e.post(route("exams.store"),{preserveScroll:!0,onSuccess:()=>{k.success("Exam created!"),D(),E.reload({only:["exams"]})},onError:()=>{},onFinish:()=>{_.value=!1}})}function L(n){C.value=n,y.value=!0}function P(){C.value&&(_.value=!0,E.delete(`/exams/${C.value.id}`,{onSuccess:()=>{k.success("Exam deleted!"),y.value=!1,E.reload({only:["exams"]})},onError:()=>{k.error("Failed to delete exam.")},onFinish:()=>{_.value=!1}}))}function Y(){y.value=!1}return(n,s)=>{const V=J("can");return c(),q(re,null,{default:r(()=>[l(a(Q),{title:"Exams"}),o("div",de,[o("div",ie,[s[9]||(s[9]=o("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100"},"Exams",-1)),b((c(),q(a(g),{variant:"default",size:"lg",onClick:O},{default:r(()=>s[8]||(s[8]=[d(" Add Exam ")])),_:1,__:[8]})),[[V,"create-exams"]])]),l(se,{headers:z,items:T.value,loading:_.value,class:"bg-white dark:bg-neutral-900 rounded-xl shadow border border-gray-200 dark:border-neutral-700"},{"item-exam_type_name":r(t=>{var i;return[d(m((i=t.exam_type)==null?void 0:i.name),1)]}),"item-class_name":r(t=>{var i;return[d(m(((i=t.class)==null?void 0:i.name)??"-"),1)]}),"item-section_name":r(t=>{var i;return[d(m(((i=t.section)==null?void 0:i.name)??"-"),1)]}),"item-dates":r(t=>[d(m(t.start_date)+" – "+m(t.end_date),1)]),"item-actions":r(t=>[b((c(),x("button",{class:"inline-flex items-center justify-center rounded-full p-2 text-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-400 mr-1",onClick:i=>W(t),"aria-label":"Edit Exam",title:"Edit"},[l(a(ne),{class:"w-5 h-5"})],8,ue)),[[V,"update-exams"]]),b((c(),x("button",{disabled:!t.can_be_deleted,class:w(["inline-flex items-center justify-center rounded-full p-2",t.can_be_deleted?"text-red-500 focus:ring-red-400":"text-red-300 cursor-not-allowed"]),title:t.can_be_deleted?"Delete Exam":`${t.exam_papers_count} papers submitted. Cannot delete.`,onClick:i=>t.can_be_deleted&&L(t),"aria-label":"Delete Exam"},[l(a(oe),{class:"w-5 h-5"})],10,me)),[[V,"delete-exams"]])]),_:1},8,["items","loading"])]),l(a(A),{open:f.value,"onUpdate:open":s[6]||(s[6]=t=>f.value=t)},{default:r(()=>[l(a(F),null,{default:r(()=>[l(a(B),null,{default:r(()=>[l(a(M),null,{default:r(()=>[d(m(v.value?"Edit Exam":"Add Exam"),1)]),_:1})]),_:1}),o("form",{onSubmit:R(K,["prevent"]),class:"space-y-6"},[o("div",ce,[l(le,{id:"exam_type_id",modelValue:a(e).exam_type_id,"onUpdate:modelValue":s[0]||(s[0]=t=>a(e).exam_type_id=t),label:"Exam Type",required:"",options:h.value.map(t=>({label:t.name,value:t.id})),placeholder:"Select Type",error:a(e).errors.exam_type_id},null,8,["modelValue","options","error"]),l($,{id:"academic_year",modelValue:a(e).academic_year,"onUpdate:modelValue":s[1]||(s[1]=t=>a(e).academic_year=t),label:"Academic Year",required:"",placeholder:"2024-2025",error:a(e).errors.academic_year},null,8,["modelValue","error"]),o("div",_e,[s[10]||(s[10]=o("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},[d(" Select Classes "),o("span",{class:"text-red-500"},"*")],-1)),o("div",pe,[(c(!0),x(X,null,Z(N.value,t=>(c(),x("label",{key:t.id,class:w(["cursor-pointer px-4 py-2 rounded-lg border transition-all duration-200 text-sm select-none",a(e).class_ids.includes(t.id)?"bg-blue-300 text-white border-blue-600":"bg-transparent text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-neutral-800"])},[b(o("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":s[2]||(s[2]=i=>a(e).class_ids=i),class:"hidden"},null,8,xe),[[ee,a(e).class_ids]]),d(" "+m(t.name),1)],2))),128))]),a(e).errors.class_ids?(c(),x("p",fe,m(a(e).errors.class_ids),1)):j("",!0)]),l($,{id:"start_date",modelValue:a(e).start_date,"onUpdate:modelValue":s[3]||(s[3]=t=>a(e).start_date=t),label:"Start Date",type:"date",required:"",error:a(e).errors.start_date},null,8,["modelValue","error"]),l($,{id:"end_date",modelValue:a(e).end_date,"onUpdate:modelValue":s[4]||(s[4]=t=>a(e).end_date=t),label:"End Date",type:"date",required:"",error:a(e).errors.end_date},null,8,["modelValue","error"]),o("div",ve,[s[11]||(s[11]=o("label",{for:"instructions",class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},[d(" Instructions "),o("span",{class:"text-red-500"},"*")],-1)),b(o("textarea",{id:"instructions","onUpdate:modelValue":s[5]||(s[5]=t=>a(e).instructions=t),rows:"3",placeholder:"Optional instructions",required:"",class:"w-full px-3 py-2 rounded-md border bg-white dark:bg-neutral-900 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500"},null,512),[[te,a(e).instructions]]),a(e).errors.instructions?(c(),x("p",ye,m(a(e).errors.instructions),1)):j("",!0)])]),o("div",be,[l(a(g),{type:"button",variant:"outline",onClick:D},{default:r(()=>s[12]||(s[12]=[d("Cancel")])),_:1,__:[12]}),l(a(g),{type:"submit",disabled:_.value},{default:r(()=>[d(m(v.value?"Update Exam":"Create Exam"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1},8,["open"]),l(a(A),{open:y.value,"onUpdate:open":s[7]||(s[7]=t=>y.value=t)},{default:r(()=>[l(a(F),null,{default:r(()=>[l(a(B),null,{default:r(()=>[l(a(M),null,{default:r(()=>s[13]||(s[13]=[d("Delete Exam?")])),_:1,__:[13]})]),_:1}),s[16]||(s[16]=o("div",{class:"mb-4"},"Are you sure you want to delete this exam? This action can’t be undone.",-1)),l(a(ae),null,{default:r(()=>[l(a(g),{variant:"outline",onClick:Y},{default:r(()=>s[14]||(s[14]=[d("Cancel")])),_:1,__:[14]}),l(a(g),{variant:"destructive",onClick:P},{default:r(()=>s[15]||(s[15]=[d("Delete")])),_:1,__:[15]})]),_:1})]),_:1,__:[16]})]),_:1},8,["open"])]),_:1})}}});export{Oe as default};
