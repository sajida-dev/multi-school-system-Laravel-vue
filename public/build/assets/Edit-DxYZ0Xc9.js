import{s as E,L as B,c as a,H as L,x as j,w as R,b as h,o as c,e as q,f as w,g as l,u as n,h as C,i as N,W as f,O as _,l as b}from"./app-0hD9jktS.js";import{_ as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-C_OfVMdc.js";import{_ as T}from"./AdmissionsForm.vue_vue_type_script_setup_true_lang-Ap7fPlA1.js";import{u as V}from"./school-SWVnhMs_.js";import"./RovingFocusGroup-BrsbekXI.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DLhJV-ve.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DV00-4L5.js";import"./building-2-0J7JWYjO.js";import"./users-CQiJNf1m.js";import"./chevron-down-Bc9-FnA7.js";import"./check-DytFQTDT.js";import"./SelectInput-C8qFFp1m.js";import"./Label.vue_vue_type_script_setup_true_lang-CLv8w6I-.js";import"./Input.vue_vue_type_script_setup_true_lang-ByoFr_iA.js";import"./InputError.vue_vue_type_script_setup_true_lang-BnFbo3YU.js";import"./FileInput-kSoIAmJU.js";import"./Icon.vue_vue_type_script_setup_true_lang-DgG5U0yt.js";import"./loader-circle-Dg-d1WoA.js";import"./target-nv-k3IQz.js";import"./triangle-alert-dLAnWNBM.js";import"./refresh-cw-DBp2ONfo.js";import"./save-DvCxJJrq.js";import"./plus-DX8dkZyx.js";import"./arrow-right-yGz9ZWmd.js";import"./arrow-left-B5cZ3DqQ.js";import"./eye-off-B84CHv0x.js";import"./eye-Dtz9j6o0.js";import"./shield-BxF9Ptyz.js";import"./square-pen-QEAPgpV6.js";import"./info-DWKpZpD6.js";import"./calendar-DjniW4jB.js";import"./house-D65vkcx-.js";import"./book-open-Dculjk7S.js";import"./trash-hGn8IamB.js";const W={class:"p-4 bg-neutral-100 dark:bg-neutral-900 min-h-screen"},$={key:1,class:"flex items-center justify-center py-10"},ko={__name:"Edit",setup(D){const v=[{title:"Admissions",href:"/admissions"},{title:"Edit Student"}],o=E().props.student,m=V(),{schools:d,classes:p,selectedSchool:g}=B(m),i=a(()=>Array.isArray(d.value)?d.value:[]),u=a(()=>Array.isArray(p.value)?p.value:[]),y=a(()=>i.value),x=a(()=>u.value.map(s=>({label:s.name,value:s.id})));L(()=>{i.value.length||m.fetchSchools()});const t=j({school_id:o.school_id,class_id:o.class_id,nationality:o.nationality,registration_number:o.registration_number,name:o.name,b_form_number:o.b_form_number,admission_date:o.admission_date,date_of_birth:o.date_of_birth,gender:o.gender,class_shift:o.class_shift,previous_school:o.previous_school,inclusive:o.inclusive,other_inclusive_type:o.other_inclusive_type,religion:o.religion,is_bricklin:o.is_bricklin,is_orphan:o.is_orphan,is_qsc:o.is_qsc,profile_photo_path:null,father_name:o.father_name,guardian_name:o.guardian_name,father_cnic:o.father_cnic,mother_cnic:o.mother_cnic,father_profession:o.father_profession,no_of_children:o.no_of_children,job_type:o.job_type,father_education:o.father_education,mother_education:o.mother_education,mother_profession:o.mother_profession,father_income:o.father_income,mother_income:o.mother_income,household_income:o.household_income,permanent_address:o.permanent_address,phone_no:o.phone_no,mobile_no:o.mobile_no});R([()=>g.value,()=>i.value],([s,e])=>{if(s&&Array.isArray(e)&&e.length>0){const r=e.find(A=>A.id===s.id);r&&t.school_id!==r.id&&(t.school_id=r.id,m.setSchool(r))}},{immediate:!0});function k(){t.post(_("admissions.update",o.id),{forceFormData:!0,data:{...t.data(),_method:"PUT"},onSuccess:()=>{b.success("Student updated successfully!"),f.visit(_("admissions.index"))},onError:()=>{b.error("Please fix the errors in the form.")}})}function S(){f.visit(_("admissions.index"))}return(s,e)=>(c(),h(P,{breadcrumbs:v},{default:q(()=>[w(n(C),{title:"Edit Student"}),l("div",W,[e[1]||(e[1]=l("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 mb-4"},"Edit Student",-1)),i.value.length&&u.value.length?(c(),h(T,{key:0,form:n(t),errors:n(t).errors,mode:"edit",classes:x.value,schools:y.value,"existing-photo":n(o).profile_photo_path,onSubmit:k,onCancel:S},null,8,["form","errors","classes","schools","existing-photo"])):(c(),N("div",$,e[0]||(e[0]=[l("span",null,"Loading...",-1)])))])]),_:1}))}};export{ko as default};
