import{L as w,c as l,H as B,x as N,w as h,b as p,o as a,e as C,f as L,g as f,u as m,h as P,i as c,z as R,W as v,O as d,l as b}from"./app-oDzFbDpS.js";import{_ as V}from"./AppLayout.vue_vue_type_script_setup_true_lang-B8xcv65_.js";import{_ as j}from"./AdmissionsForm.vue_vue_type_script_setup_true_lang-BYY5rFtq.js";import{u as E}from"./school-T4gwIvXC.js";import"./RovingFocusGroup-CLnOwjDo.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DPNLz3sn.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cob2K5o9.js";import"./building-2-Dp0U14zc.js";import"./users-DDnJbTSp.js";import"./chevron-down-SN-issHr.js";import"./check-CEIiCWnz.js";import"./SelectInput-DixG2iKA.js";import"./Label.vue_vue_type_script_setup_true_lang-BphRAz40.js";import"./Input.vue_vue_type_script_setup_true_lang-CJXbLAqT.js";import"./InputError.vue_vue_type_script_setup_true_lang-DL9oimPF.js";import"./FileInput-BK6eYL8g.js";import"./Icon.vue_vue_type_script_setup_true_lang-CktM08l_.js";import"./loader-circle-Dd3mNCCo.js";import"./target-BvkpxWi2.js";import"./triangle-alert-DX_7JuLF.js";import"./refresh-cw-CWAu1Of8.js";import"./save-BhC_gGhx.js";import"./plus-DaPcSaFA.js";import"./arrow-right-Dpm9A9Fy.js";import"./arrow-left-DCJF3lDn.js";import"./eye-off-ByIEJSqi.js";import"./eye-DjBiqAnr.js";import"./shield-CQ-AXaLs.js";import"./square-pen-D5JRiJpv.js";import"./info-Cu4eEvQq.js";import"./calendar-NzJ3-Hzp.js";import"./house-CZga5bkn.js";import"./book-open-NJHJ4pEX.js";import"./trash-Byk8sBRk.js";const U={class:"p-4 bg-neutral-100 dark:bg-neutral-900 min-h-screen"},W={key:1,class:"flex flex-col items-center justify-center py-10 gap-2"},$={key:0},q={key:1},z={key:2},ke={__name:"Create",setup(D){const i=E(),{schools:u,classes:_}=w(i),o=l(()=>Array.isArray(u.value)?u.value:[]),n=l(()=>Array.isArray(_.value)?_.value:[]),y=l(()=>o.value),g=l(()=>n.value.map(s=>({label:s.name,value:s.id})));B(()=>{o.value.length||i.fetchSchools()});const k=[{title:"Admissions",href:"/admissions"},{title:"Add Student"}],t=N({school_id:null,class_id:null,nationality:"",registration_number:"",name:"",b_form_number:"",admission_date:"",date_of_birth:"",gender:"",class_shift:"",previous_school:"",inclusive:"",other_inclusive_type:"",religion:"",is_bricklin:!1,is_orphan:!1,is_qsc:!1,profile_photo_path:null,father_name:"",guardian_name:"",father_cnic:"",mother_cnic:"",father_profession:"",no_of_children:"",job_type:"",father_education:"",mother_education:"",mother_profession:"",father_income:"",mother_income:"",household_income:"",permanent_address:"",phone_no:"",mobile_no:""});h(()=>t.school_id,s=>{const e=Array.isArray(o.value)?o.value.find(r=>r.id===s):void 0;e&&i.setSchool(e)}),h([()=>i.selectedSchool,()=>o.value],([s,e])=>{if(s&&Array.isArray(e)&&e.length>0){const r=e.find(S=>S.id===s.id);r&&t.school_id!==r.id&&(t.school_id=r.id,t.class_id=null,i.setSchool(r))}},{immediate:!0});function x(){t.post(d("admissions.store"),{forceFormData:!0,onSuccess:()=>{b.success("Student added successfully!"),v.visit(d("admissions.index"))},onError:()=>{b.error("Please fix the errors in the form.")}})}function A(){v.visit(d("admissions.index"))}return(s,e)=>(a(),p(V,{breadcrumbs:k},{default:C(()=>[L(m(P),{title:"Add New Student"}),f("div",U,[e[0]||(e[0]=f("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 mb-4"},"Add New Student",-1)),o.value.length&&n.value.length?(a(),p(j,{key:0,form:m(t),errors:m(t).errors,mode:"create",classes:g.value,schools:y.value,onSubmit:x,onCancel:A},null,8,["form","errors","classes","schools"])):(a(),c("div",W,[!o.value.length&&!n.value.length?(a(),c("span",$,"Loading schools and classes...")):o.value.length?n.value.length?R("",!0):(a(),c("span",z,"Unable to load classes. Please check your network or contact admin.")):(a(),c("span",q,"Unable to load schools. Please check your network or contact admin."))]))])]),_:1}))}};export{ke as default};
