import{d as W,r as m,w as D,b as F,o as x,u as e,E as R,e as n,f as l,g as r,C as A,j as u,k as C,n as K,_ as E,p as L,B as I,W as V,x as Z,y as ee,h as te,i as g,z as q,A as O,t as p,F as ae,m as se,K as le,D as ne,l as U}from"./app-oDzFbDpS.js";import{_ as re}from"./BaseDataTable.vue_vue_type_style_index_0_lang-dE9UHpEE.js";import{_ as z}from"./DialogHeader.vue_vue_type_script_setup_true_lang-BpgOtXzy.js";import{_ as oe,a as B}from"./SelectInput-DixG2iKA.js";import{_ as de}from"./ManageLayout.vue_vue_type_script_setup_true_lang-3BtKD-jU.js";import{R as ie}from"./refresh-cw-CWAu1Of8.js";import{S as ue}from"./square-pen-D5JRiJpv.js";import{T as me}from"./trash-Byk8sBRk.js";import"./Label.vue_vue_type_script_setup_true_lang-BphRAz40.js";import"./Input.vue_vue_type_script_setup_true_lang-CJXbLAqT.js";import"./InputError.vue_vue_type_script_setup_true_lang-DL9oimPF.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-B8xcv65_.js";import"./RovingFocusGroup-CLnOwjDo.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DPNLz3sn.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cob2K5o9.js";import"./building-2-Dp0U14zc.js";import"./users-DDnJbTSp.js";import"./school-T4gwIvXC.js";import"./chevron-down-SN-issHr.js";import"./check-CEIiCWnz.js";import"./clipboard-list-BsqG52_M.js";import"./loader-circle-Dd3mNCCo.js";const _e={class:"flex justify-end space-x-2"},ce=W({__name:"ExtendDeadlineModal",props:{show:Boolean,exam:Object},emits:["close"],setup(h,{emit:f}){var c;const v=h,$=f,y=m(v.show);D(()=>v.show,i=>{y.value=i}),D(y,i=>{i||$("close")});const b=m({result_entry_deadline:((c=v.exam)==null?void 0:c.result_entry_deadline)??""});D(()=>v.exam,i=>{b.value.result_entry_deadline=(i==null?void 0:i.result_entry_deadline)??""});const w=()=>{var i;V.put(route("exams.extend-deadline",(i=v.exam)==null?void 0:i.id),b.value,{onSuccess:()=>{T()}})},T=()=>{y.value=!1};return(i,d)=>(x(),F(e(R),{open:y.value,"onUpdate:open":d[1]||(d[1]=k=>y.value=k)},{default:n(()=>[l(e(I),null,{default:n(()=>[l(e(z),null,{default:n(()=>[l(e(A),null,{default:n(()=>d[2]||(d[2]=[u("Extend Result Entry Deadline")])),_:1,__:[2]})]),_:1}),r("form",{onSubmit:L(w,["prevent"]),class:"space-y-4"},[r("div",null,[d[3]||(d[3]=r("label",{for:"new-deadline",class:"block text-sm font-medium text-gray-700"}," New Deadline ",-1)),C(r("input",{id:"new-deadline",type:"datetime-local","onUpdate:modelValue":d[0]||(d[0]=k=>b.value.result_entry_deadline=k),class:"mt-1 block w-full border border-gray-300 p-2 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"},null,512),[[K,b.value.result_entry_deadline]])]),r("div",_e,[l(e(E),{type:"button",variant:"outline",onClick:T},{default:n(()=>d[4]||(d[4]=[u("Cancel")])),_:1,__:[4]}),l(e(E),{type:"submit",variant:"default"},{default:n(()=>d[5]||(d[5]=[u("Update")])),_:1,__:[5]})])],32)]),_:1})]),_:1},8,["open"]))}}),pe={class:"max-w-6xl mx-auto w-full px-2 sm:px-4 md:px-0 py-8"},xe={class:"flex justify-between items-center mb-6"},fe=["onClick"],ve=["onClick"],ye=["disabled","title","onClick"],be={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ge={class:"md:col-span-2"},Ee={class:"flex flex-wrap gap-3"},ke=["value"],Ce={key:0,class:"text-red-500 text-sm mt-1"},De={class:"md:col-span-2"},Se={key:0,class:"text-red-500 text-sm mt-1"},Ve={class:"flex justify-end space-x-3"},Je=W({__name:"ExamsIndex",props:{exams:{},examTypes:{},classes:{}},setup(h){const f=h,v=m([...f.exams]),$=m([...f.examTypes]),y=m([...f.classes]);m([]);const b=m(!1),w=m(void 0),T=o=>{w.value=o,b.value=!0};D(()=>f.exams,o=>v.value=[...o]),D(()=>f.examTypes,o=>$.value=[...o]),D(()=>f.classes,o=>y.value=[...o]);const c=m(!1),i=m(!1),d=m(!1),k=m(null),S=m(!1),N=m(null),t=Z({id:null,exam_type_id:"",class_id:"",class_ids:[],result_entry_deadline:"",start_date:"",end_date:"",instructions:""}),P=[{text:"ID",value:"id"},{text:"Title",value:"title"},{text:"Type",value:"exam_type_name",sortable:!1,slotName:"item-exam_type_name"},{text:"Class",value:"class_name",sortable:!1,slotName:"item-class_name"},{text:"Section",value:"section_name",sortable:!1,slotName:"item-section_name"},{text:"Dates",value:"dates",sortable:!1,slotName:"item-dates"},{text:"Status",value:"status"},{text:"Actions",value:"actions",sortable:!1,slotName:"item-actions"}];function G(){d.value=!1,k.value=null,t.reset(),i.value=!0}function H(o){d.value=!0,k.value=o,t.reset(),t.id=o.id,t.exam_type_id=o.exam_type.id??"",t.class_id=o.class_id,t.result_entry_deadline=o.result_entry_deadline,t.start_date=o.start_date,t.end_date=o.end_date,t.instructions=o.instructions??"",i.value=!0}function M(){i.value=!1}function J(){c.value=!0,t.exam_type_id===""||t.exam_type_id,t.class_ids.length>0&&t.class_ids,t.result_entry_deadline,t.start_date,t.end_date,t.instructions,d.value&&t.id!==null?t.put(`/exams/${t.id}`,{preserveScroll:!0,onSuccess:()=>{U.success("Exam updated!"),M(),V.reload({only:["exams"]})},onError:()=>{},onFinish:()=>{c.value=!1}}):t.post(route("exams.store"),{preserveScroll:!0,onSuccess:()=>{U.success("Exam created!"),M(),V.reload({only:["exams"]})},onError:()=>{},onFinish:()=>{c.value=!1}})}function Q(o){N.value=o,S.value=!0}function X(){N.value&&(c.value=!0,V.delete(`/exams/${N.value.id}`,{onSuccess:()=>{U.success("Exam deleted!"),S.value=!1,V.reload({only:["exams"]})},onError:()=>{U.error("Failed to delete exam.")},onFinish:()=>{c.value=!1}}))}function Y(){S.value=!1}return(o,s)=>{const j=ee("can");return x(),F(de,null,{default:n(()=>[l(e(te),{title:"Exams"}),r("div",pe,[r("div",xe,[s[10]||(s[10]=r("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100"},"Exams",-1)),C((x(),F(e(E),{variant:"default",size:"lg",onClick:G},{default:n(()=>s[9]||(s[9]=[u(" Add Exam ")])),_:1,__:[9]})),[[j,"create-exams"]])]),l(re,{headers:P,items:v.value,loading:c.value,class:"bg-white dark:bg-neutral-900 rounded-xl shadow border border-gray-200 dark:border-neutral-700"},{"item-exam_type_name":n(a=>{var _;return[u(p((_=a.exam_type)==null?void 0:_.name),1)]}),"item-class_name":n(a=>{var _;return[u(p(((_=a.class)==null?void 0:_.name)??"-"),1)]}),"item-section_name":n(a=>{var _;return[u(p(((_=a.section)==null?void 0:_.name)??"-"),1)]}),"item-dates":n(a=>[u(p(a.start_date)+" – "+p(a.end_date),1)]),"item-actions":n(a=>[a.status==="in_progress"||a.status==="scheduled"?(x(),g("button",{key:0,class:"inline-flex items-center justify-center rounded-full p-2 text-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-400 mr-1",onClick:_=>T(a),"aria-label":"Extend Exam",title:"Extend Result Entry Deadline"},[l(e(ie),{class:"w-5 h-5"})],8,fe)):q("",!0),C((x(),g("button",{class:"inline-flex items-center justify-center rounded-full p-2 text-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-400 mr-1",onClick:_=>H(a),"aria-label":"Edit Exam",title:"Edit"},[l(e(ue),{class:"w-5 h-5"})],8,ve)),[[j,"update-exams"]]),C((x(),g("button",{disabled:!a.can_be_deleted,class:O(["inline-flex items-center justify-center rounded-full p-2",a.can_be_deleted?"text-red-500 focus:ring-red-400":"text-red-300 cursor-not-allowed"]),title:a.can_be_deleted?"Delete Exam":`${a.exam_papers_count} papers submitted. Cannot delete.`,onClick:_=>a.can_be_deleted&&Q(a),"aria-label":"Delete Exam"},[l(e(me),{class:"w-5 h-5"})],10,ye)),[[j,"delete-exams"]])]),_:1},8,["items","loading"])]),l(e(R),{open:i.value,"onUpdate:open":s[6]||(s[6]=a=>i.value=a)},{default:n(()=>[l(e(I),null,{default:n(()=>[l(e(z),null,{default:n(()=>[l(e(A),null,{default:n(()=>[u(p(d.value?"Edit Exam":"Add Exam"),1)]),_:1})]),_:1}),r("form",{onSubmit:L(J,["prevent"]),class:"space-y-6"},[r("div",be,[l(oe,{id:"exam_type_id",modelValue:e(t).exam_type_id,"onUpdate:modelValue":s[0]||(s[0]=a=>e(t).exam_type_id=a),label:"Exam Type",required:"",options:$.value.map(a=>({label:a.name,value:a.id})),placeholder:"Select Type",error:e(t).errors.exam_type_id},null,8,["modelValue","options","error"]),l(B,{id:"result_entry_deadline",type:"date",modelValue:e(t).result_entry_deadline,"onUpdate:modelValue":s[1]||(s[1]=a=>e(t).result_entry_deadline=a),label:"Result Entry Deadline",required:"",placeholder:"Select Result Entry Deadline",error:e(t).errors.result_entry_deadline},null,8,["modelValue","error"]),r("div",ge,[s[11]||(s[11]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},[u(" Select Classes "),r("span",{class:"text-red-500"},"*")],-1)),r("div",Ee,[(x(!0),g(ae,null,se(y.value,a=>(x(),g("label",{key:a.id,class:O(["cursor-pointer px-4 py-2 rounded-lg border transition-all duration-200 text-sm select-none",e(t).class_ids.includes(a.id)?"bg-blue-300 text-white border-blue-600":"bg-transparent text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-neutral-800"])},[C(r("input",{type:"checkbox",value:a.id,"onUpdate:modelValue":s[2]||(s[2]=_=>e(t).class_ids=_),class:"hidden"},null,8,ke),[[le,e(t).class_ids]]),u(" "+p(a.name),1)],2))),128))]),e(t).errors.class_ids?(x(),g("p",Ce,p(e(t).errors.class_ids),1)):q("",!0)]),l(B,{id:"start_date",modelValue:e(t).start_date,"onUpdate:modelValue":s[3]||(s[3]=a=>e(t).start_date=a),label:"Start Date",type:"date",required:"",error:e(t).errors.start_date},null,8,["modelValue","error"]),l(B,{id:"end_date",modelValue:e(t).end_date,"onUpdate:modelValue":s[4]||(s[4]=a=>e(t).end_date=a),label:"End Date",type:"date",required:"",error:e(t).errors.end_date},null,8,["modelValue","error"]),r("div",De,[s[12]||(s[12]=r("label",{for:"instructions",class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},[u(" Instructions "),r("span",{class:"text-red-500"},"*")],-1)),C(r("textarea",{id:"instructions","onUpdate:modelValue":s[5]||(s[5]=a=>e(t).instructions=a),rows:"3",placeholder:"Optional instructions",required:"",class:"w-full px-3 py-2 rounded-md border bg-white dark:bg-neutral-900 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500"},null,512),[[K,e(t).instructions]]),e(t).errors.instructions?(x(),g("p",Se,p(e(t).errors.instructions),1)):q("",!0)])]),r("div",Ve,[l(e(E),{type:"button",variant:"outline",onClick:M},{default:n(()=>s[13]||(s[13]=[u("Cancel")])),_:1,__:[13]}),l(e(E),{type:"submit",disabled:c.value},{default:n(()=>[u(p(d.value?"Update Exam":"Create Exam"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1},8,["open"]),l(ce,{show:b.value,exam:w.value,onClose:s[7]||(s[7]=a=>b.value=!1)},null,8,["show","exam"]),l(e(R),{open:S.value,"onUpdate:open":s[8]||(s[8]=a=>S.value=a)},{default:n(()=>[l(e(I),null,{default:n(()=>[l(e(z),null,{default:n(()=>[l(e(A),null,{default:n(()=>s[14]||(s[14]=[u("Delete Exam?")])),_:1,__:[14]})]),_:1}),s[17]||(s[17]=r("div",{class:"mb-4"},"Are you sure you want to delete this exam? This action can’t be undone.",-1)),l(e(ne),null,{default:n(()=>[l(e(E),{variant:"outline",onClick:Y},{default:n(()=>s[15]||(s[15]=[u("Cancel")])),_:1,__:[15]}),l(e(E),{variant:"destructive",onClick:X},{default:n(()=>s[16]||(s[16]=[u("Delete")])),_:1,__:[16]})]),_:1})]),_:1,__:[17]})]),_:1},8,["open"])]),_:1})}}});export{Je as default};
