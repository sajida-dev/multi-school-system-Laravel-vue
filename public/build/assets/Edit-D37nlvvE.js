import{s as E,L as B,c as a,H as L,x as j,w as R,b as h,o as c,e as q,f as w,g as l,u as n,h as C,i as N,W as f,O as _,l as b}from"./app-oDzFbDpS.js";import{_ as P}from"./AppLayout.vue_vue_type_script_setup_true_lang-B8xcv65_.js";import{_ as T}from"./AdmissionsForm.vue_vue_type_script_setup_true_lang-BYY5rFtq.js";import{u as V}from"./school-T4gwIvXC.js";import"./RovingFocusGroup-CLnOwjDo.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DPNLz3sn.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-Cob2K5o9.js";import"./building-2-Dp0U14zc.js";import"./users-DDnJbTSp.js";import"./chevron-down-SN-issHr.js";import"./check-CEIiCWnz.js";import"./SelectInput-DixG2iKA.js";import"./Label.vue_vue_type_script_setup_true_lang-BphRAz40.js";import"./Input.vue_vue_type_script_setup_true_lang-CJXbLAqT.js";import"./InputError.vue_vue_type_script_setup_true_lang-DL9oimPF.js";import"./FileInput-BK6eYL8g.js";import"./Icon.vue_vue_type_script_setup_true_lang-CktM08l_.js";import"./loader-circle-Dd3mNCCo.js";import"./target-BvkpxWi2.js";import"./triangle-alert-DX_7JuLF.js";import"./refresh-cw-CWAu1Of8.js";import"./save-BhC_gGhx.js";import"./plus-DaPcSaFA.js";import"./arrow-right-Dpm9A9Fy.js";import"./arrow-left-DCJF3lDn.js";import"./eye-off-ByIEJSqi.js";import"./eye-DjBiqAnr.js";import"./shield-CQ-AXaLs.js";import"./square-pen-D5JRiJpv.js";import"./info-Cu4eEvQq.js";import"./calendar-NzJ3-Hzp.js";import"./house-CZga5bkn.js";import"./book-open-NJHJ4pEX.js";import"./trash-Byk8sBRk.js";const W={class:"p-4 bg-neutral-100 dark:bg-neutral-900 min-h-screen"},$={key:1,class:"flex items-center justify-center py-10"},ko={__name:"Edit",setup(D){const v=[{title:"Admissions",href:"/admissions"},{title:"Edit Student"}],o=E().props.student,m=V(),{schools:d,classes:p,selectedSchool:g}=B(m),i=a(()=>Array.isArray(d.value)?d.value:[]),u=a(()=>Array.isArray(p.value)?p.value:[]),y=a(()=>i.value),x=a(()=>u.value.map(s=>({label:s.name,value:s.id})));L(()=>{i.value.length||m.fetchSchools()});const t=j({school_id:o.school_id,class_id:o.class_id,nationality:o.nationality,registration_number:o.registration_number,name:o.name,b_form_number:o.b_form_number,admission_date:o.admission_date,date_of_birth:o.date_of_birth,gender:o.gender,class_shift:o.class_shift,previous_school:o.previous_school,inclusive:o.inclusive,other_inclusive_type:o.other_inclusive_type,religion:o.religion,is_bricklin:o.is_bricklin,is_orphan:o.is_orphan,is_qsc:o.is_qsc,profile_photo_path:null,father_name:o.father_name,guardian_name:o.guardian_name,father_cnic:o.father_cnic,mother_cnic:o.mother_cnic,father_profession:o.father_profession,no_of_children:o.no_of_children,job_type:o.job_type,father_education:o.father_education,mother_education:o.mother_education,mother_profession:o.mother_profession,father_income:o.father_income,mother_income:o.mother_income,household_income:o.household_income,permanent_address:o.permanent_address,phone_no:o.phone_no,mobile_no:o.mobile_no});R([()=>g.value,()=>i.value],([s,e])=>{if(s&&Array.isArray(e)&&e.length>0){const r=e.find(A=>A.id===s.id);r&&t.school_id!==r.id&&(t.school_id=r.id,m.setSchool(r))}},{immediate:!0});function k(){t.post(_("admissions.update",o.id),{forceFormData:!0,data:{...t.data(),_method:"PUT"},onSuccess:()=>{b.success("Student updated successfully!"),f.visit(_("admissions.index"))},onError:()=>{b.error("Please fix the errors in the form.")}})}function S(){f.visit(_("admissions.index"))}return(s,e)=>(c(),h(P,{breadcrumbs:v},{default:q(()=>[w(n(C),{title:"Edit Student"}),l("div",W,[e[1]||(e[1]=l("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 mb-4"},"Edit Student",-1)),i.value.length&&u.value.length?(c(),h(T,{key:0,form:n(t),errors:n(t).errors,mode:"edit",classes:x.value,schools:y.value,"existing-photo":n(o).profile_photo_path,onSubmit:k,onCancel:S},null,8,["form","errors","classes","schools","existing-photo"])):(c(),N("div",$,e[0]||(e[0]=[l("span",null,"Loading...",-1)])))])]),_:1}))}};export{ko as default};
