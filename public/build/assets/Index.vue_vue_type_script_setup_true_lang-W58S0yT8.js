import{d as O,r as u,w as G,y as H,i as D,o as b,f as a,g as d,u as s,h as J,k as $,b as K,_ as p,e as n,j as i,B as E,C as h,t as S,D as F,p as L,E as N,F as P,W as c,l as C}from"./app-oDzFbDpS.js";import{_ as Q}from"./BaseDataTable.vue_vue_type_style_index_0_lang-dE9UHpEE.js";import{_ as R}from"./Label.vue_vue_type_script_setup_true_lang-BphRAz40.js";import{_ as X}from"./Input.vue_vue_type_script_setup_true_lang-CJXbLAqT.js";import{_ as Y}from"./InputError.vue_vue_type_script_setup_true_lang-DL9oimPF.js";import{_ as U}from"./DialogHeader.vue_vue_type_script_setup_true_lang-BpgOtXzy.js";import{_ as V}from"./Icon.vue_vue_type_script_setup_true_lang-CktM08l_.js";const Z={class:"max-w-4xl mx-auto w-full px-2 sm:px-4 md:px-0 py-8"},ee={class:"flex justify-between items-center mb-6"},ae=["onClick"],le=["onClick"],se={class:"mb-4 flex flex-col gap-2"},ce=O({__name:"Index",props:{classes:{}},setup(A){const g=A,w=u(g.classes?[...g.classes]:[]);G(()=>g.classes,l=>{w.value=l?[...l]:[]});const o=u(!1),m=u(!1),f=u(!1),x=u(null),v=u(!1),_=u(null),t=u({name:"",errors:{name:""}}),B=[{text:"ID",value:"id"},{text:"Class Name",value:"name"},{text:"Actions",value:"actions",sortable:!1,slotName:"item-actions"}];function j(){f.value=!1,t.value={name:"",errors:{name:""}},m.value=!0}function M(l){f.value=!0,x.value=l,t.value={name:l.name,errors:{name:""}},m.value=!0}function y(){m.value=!1,t.value={name:"",errors:{name:""}},x.value=null}async function T(){o.value=!0,t.value.errors={name:""};try{if(f.value&&x.value)c.put(`/classes/${x.value.id}`,{name:t.value.name},{onSuccess:()=>{C.success("Class updated!"),y(),c.reload({only:["classes"]})},onError:l=>{l.name?t.value.errors.name=l.name:typeof l=="string"?t.value.errors.name=l:t.value.errors.name="Update failed.",console.error("Update errors:",l)},onFinish:()=>{o.value=!1}});else{const l={name:t.value.name};console.log("Creating class with payload:",l),c.post("/classes",l,{onSuccess:()=>{C.success("Class created!"),y(),c.reload({only:["classes"]})},onError:e=>{e.name?t.value.errors.name=e.name:typeof e=="string"?t.value.errors.name=e:t.value.errors.name="Creation failed.",console.error("Creation errors:",e)},onFinish:()=>{o.value=!1}})}}catch(l){console.error("Error in handleSubmit:",l),C.error("An error occurred: "+l.message),o.value=!1}}function I(l){_.value=l,v.value=!0}async function W(){_.value&&(o.value=!0,c.delete(`/classes/${_.value.id}`,{onSuccess:()=>{C.success("Class deleted!"),v.value=!1,_.value=null,c.reload({only:["classes"]})},onError:()=>{C.error("Failed to delete class.")},onFinish:()=>{o.value=!1}}))}function q(){v.value=!1,_.value=null}return(l,e)=>{const k=H("can");return b(),D(P,null,[a(s(J),{title:"Classes"}),d("div",Z,[d("div",ee,[e[4]||(e[4]=d("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100"},"Classes",-1)),$((b(),K(s(p),{variant:"default",size:"lg",class:"mr-2",onClick:j},{default:n(()=>e[3]||(e[3]=[i("Add Class")])),_:1,__:[3]})),[[k,"create-classes"]])]),a(Q,{headers:B,items:w.value,loading:o.value,class:"bg-white dark:bg-neutral-900 rounded-xl shadow border border-gray-200 dark:border-neutral-700"},{"item-actions":n(r=>[$((b(),D("button",{class:"inline-flex items-center justify-center rounded-full p-2 text-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-400 mr-1",onClick:z=>M(r),"aria-label":"Edit Class",title:"Edit Class"},[a(V,{name:"edit",class:"w-5 h-5"})],8,ae)),[[k,"update-classes"]]),$((b(),D("button",{class:"inline-flex items-center justify-center rounded-full p-2 text-red-500 focus:outline-none focus:ring-2 focus:ring-red-400",onClick:z=>I(r),"aria-label":"Delete Class",title:"Delete Class"},[a(V,{name:"trash",class:"w-5 h-5"})],8,le)),[[k,"delete-classes"]])]),_:1},8,["items","loading"])]),a(s(N),{open:m.value,"onUpdate:open":e[1]||(e[1]=r=>m.value=r)},{default:n(()=>[a(s(E),null,{default:n(()=>[a(s(U),null,{default:n(()=>[a(s(h),null,{default:n(()=>[i(S(f.value?"Edit Class":"Add Class"),1)]),_:1})]),_:1}),d("form",{onSubmit:L(T,["prevent"])},[d("div",se,[a(s(R),{for:"name"},{default:n(()=>e[5]||(e[5]=[i("Class Name")])),_:1,__:[5]}),a(s(X),{id:"name",modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=r=>t.value.name=r),type:"text",required:"",placeholder:"Class name"},null,8,["modelValue"]),a(Y,{message:t.value.errors.name},null,8,["message"])]),a(s(F),null,{default:n(()=>[a(s(p),{type:"button",variant:"outline",onClick:y},{default:n(()=>e[6]||(e[6]=[i("Cancel")])),_:1,__:[6]}),a(s(p),{disabled:o.value},{default:n(()=>[i(S(f.value?"Update":"Create"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),a(s(N),{open:v.value,"onUpdate:open":e[2]||(e[2]=r=>v.value=r)},{default:n(()=>[a(s(E),null,{default:n(()=>[a(s(U),null,{default:n(()=>[a(s(h),null,{default:n(()=>e[7]||(e[7]=[i("Delete Class?")])),_:1,__:[7]})]),_:1}),e[10]||(e[10]=d("div",{class:"mb-4"},"Are you sure you want to delete this class? This action cannot be undone.",-1)),a(s(F),null,{default:n(()=>[a(s(p),{variant:"outline",onClick:q},{default:n(()=>e[8]||(e[8]=[i("Cancel")])),_:1,__:[8]}),a(s(p),{variant:"destructive",onClick:W},{default:n(()=>e[9]||(e[9]=[i("Delete")])),_:1,__:[9]})]),_:1})]),_:1,__:[10]})]),_:1},8,["open"])],64)}}});export{ce as _};
