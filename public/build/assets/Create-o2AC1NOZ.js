import{L as w,c as l,H as B,x as N,w as h,b as p,o as a,e as C,f as L,g as f,u as m,h as P,i as c,z as R,W as v,O as d,l as b}from"./app-0hD9jktS.js";import{_ as V}from"./AppLayout.vue_vue_type_script_setup_true_lang-C_OfVMdc.js";import{_ as j}from"./AdmissionsForm.vue_vue_type_script_setup_true_lang-Ap7fPlA1.js";import{u as E}from"./school-SWVnhMs_.js";import"./RovingFocusGroup-BrsbekXI.js";import"./AvatarImage.vue_vue_type_script_setup_true_lang-DLhJV-ve.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-DV00-4L5.js";import"./building-2-0J7JWYjO.js";import"./users-CQiJNf1m.js";import"./chevron-down-Bc9-FnA7.js";import"./check-DytFQTDT.js";import"./SelectInput-C8qFFp1m.js";import"./Label.vue_vue_type_script_setup_true_lang-CLv8w6I-.js";import"./Input.vue_vue_type_script_setup_true_lang-ByoFr_iA.js";import"./InputError.vue_vue_type_script_setup_true_lang-BnFbo3YU.js";import"./FileInput-kSoIAmJU.js";import"./Icon.vue_vue_type_script_setup_true_lang-DgG5U0yt.js";import"./loader-circle-Dg-d1WoA.js";import"./target-nv-k3IQz.js";import"./triangle-alert-dLAnWNBM.js";import"./refresh-cw-DBp2ONfo.js";import"./save-DvCxJJrq.js";import"./plus-DX8dkZyx.js";import"./arrow-right-yGz9ZWmd.js";import"./arrow-left-B5cZ3DqQ.js";import"./eye-off-B84CHv0x.js";import"./eye-Dtz9j6o0.js";import"./shield-BxF9Ptyz.js";import"./square-pen-QEAPgpV6.js";import"./info-DWKpZpD6.js";import"./calendar-DjniW4jB.js";import"./house-D65vkcx-.js";import"./book-open-Dculjk7S.js";import"./trash-hGn8IamB.js";const U={class:"p-4 bg-neutral-100 dark:bg-neutral-900 min-h-screen"},W={key:1,class:"flex flex-col items-center justify-center py-10 gap-2"},$={key:0},q={key:1},z={key:2},ke={__name:"Create",setup(D){const i=E(),{schools:u,classes:_}=w(i),o=l(()=>Array.isArray(u.value)?u.value:[]),n=l(()=>Array.isArray(_.value)?_.value:[]),y=l(()=>o.value),g=l(()=>n.value.map(s=>({label:s.name,value:s.id})));B(()=>{o.value.length||i.fetchSchools()});const k=[{title:"Admissions",href:"/admissions"},{title:"Add Student"}],t=N({school_id:null,class_id:null,nationality:"",registration_number:"",name:"",b_form_number:"",admission_date:"",date_of_birth:"",gender:"",class_shift:"",previous_school:"",inclusive:"",other_inclusive_type:"",religion:"",is_bricklin:!1,is_orphan:!1,is_qsc:!1,profile_photo_path:null,father_name:"",guardian_name:"",father_cnic:"",mother_cnic:"",father_profession:"",no_of_children:"",job_type:"",father_education:"",mother_education:"",mother_profession:"",father_income:"",mother_income:"",household_income:"",permanent_address:"",phone_no:"",mobile_no:""});h(()=>t.school_id,s=>{const e=Array.isArray(o.value)?o.value.find(r=>r.id===s):void 0;e&&i.setSchool(e)}),h([()=>i.selectedSchool,()=>o.value],([s,e])=>{if(s&&Array.isArray(e)&&e.length>0){const r=e.find(S=>S.id===s.id);r&&t.school_id!==r.id&&(t.school_id=r.id,t.class_id=null,i.setSchool(r))}},{immediate:!0});function x(){t.post(d("admissions.store"),{forceFormData:!0,onSuccess:()=>{b.success("Student added successfully!"),v.visit(d("admissions.index"))},onError:()=>{b.error("Please fix the errors in the form.")}})}function A(){v.visit(d("admissions.index"))}return(s,e)=>(a(),p(V,{breadcrumbs:k},{default:C(()=>[L(m(P),{title:"Add New Student"}),f("div",U,[e[0]||(e[0]=f("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 mb-4"},"Add New Student",-1)),o.value.length&&n.value.length?(a(),p(j,{key:0,form:m(t),errors:m(t).errors,mode:"create",classes:g.value,schools:y.value,onSubmit:x,onCancel:A},null,8,["form","errors","classes","schools"])):(a(),c("div",W,[!o.value.length&&!n.value.length?(a(),c("span",$,"Loading schools and classes...")):o.value.length?n.value.length?R("",!0):(a(),c("span",z,"Unable to load classes. Please check your network or contact admin.")):(a(),c("span",q,"Unable to load schools. Please check your network or contact admin."))]))])]),_:1}))}};export{ke as default};
